import S, { useState, useEffect, useRef, useCallback, useLayoutEffect, useSyncExternalStore } from 'react';
import p from 'js-cookie';
import { Awaiting, Success, Failure } from '@tactics/js-monad';

function U(e,o){let[t,r]=useState(e);return useEffect(()=>{let s=setTimeout(()=>{r(e);},o);return ()=>{clearTimeout(s);}},[e,o]),t}function E(e,o=500){let[t,r]=useState(e),s=useRef(null);return useEffect(()=>{let n=Date.now();if(s.current&&n>=s.current+o)s.current=n,r(e);else {let u=window.setTimeout(()=>{s.current=n,r(e);},o);return ()=>window.clearTimeout(u)}},[e,o]),t}function ee(){let[e,o]=useState({width:0,height:0}),t=useCallback(()=>{o({width:window.innerWidth||0,height:window.innerHeight||0});},[]);return useEffect(()=>{t();},[t]),window.addEventListener("resize",t),window.addEventListener("orientationchange",t),e}function te(){let[e,o]=S.useState({width:0,height:0}),t=S.useRef(null);return [S.useCallback(s=>{if(t.current&&(t.current.disconnect(),t.current=null),s.nodeType===Node.ELEMENT_NODE){let n=new ResizeObserver(([u])=>{if(u&&u.borderBoxSize){let{inlineSize:c,blockSize:a}=u.borderBoxSize[0];o({width:c,height:a});}});n.observe(s),t.current=n;}},[]),e]}function H(e){return "clientX"in e}function z(e){return "touches"in e}function oe(e,o={}){let{threshold:t=400,onStart:r,onFinish:s,onCancel:n}=o,u=S.useRef(!1),c=S.useRef(!1),a=S.useRef();return S.useMemo(()=>{if(typeof e!="function")return {};let f=d=>{!H(d)&&!z(d)||(r&&r(d),c.current=!0,a.current=window.setTimeout(()=>{e(d),u.current=!0;},t));},i=d=>{!H(d)&&!z(d)||(u.current?s&&s(d):c.current&&n&&n(d),u.current=!1,c.current=!1,a.current&&window.clearTimeout(a.current));};return {...{onMouseDown:f,onMouseUp:i,onMouseLeave:i},...{onTouchStart:f,onTouchEnd:i}}},[e,t,n,s,r])}var re=e=>(document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e);});function se(){useLayoutEffect(()=>{let e=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e;}},[]);}function l(e,o,t=window){let r=useRef(o);useEffect(()=>{r.current=o;},[o]),useEffect(()=>{if(!t)return;let s=n=>r.current(n);return t.addEventListener(e,s),()=>{t.removeEventListener(e,s);}},[e,t]);}function ce(e){let[o,t]=useState(!1);return e.current&&(l("mouseover",()=>t(!0),e.current),l("mouseout",()=>t(!1),e.current)),o}var x=class{get length(){return Object.keys(p.get()).length}clear(){let o=p.get();for(let t in o)p.remove(t);}getItem(o){let t=p.get(o);return t!==void 0?t:null}key(o){let t=Object.keys(p.get());return t.length>o?t[o]:null}removeItem(o){p.remove(o);}setItem(o,t){p.set(o,t);}toString(){return JSON.stringify(p.get(),null,2)}};function le(e){S.useEffect(()=>{document.title=e;},[e]);}function de(e){useEffect(()=>{let t=document.querySelector('link[rel="icon"]:not([type="image/svg+xml"])');t||(t=document.createElement("link"),t.rel="icon",document.head.appendChild(t)),t.href=e;},[e]);}function pe(e){useEffect(()=>{let t=document.querySelector('link[rel="icon"][type="image/svg+xml"]');t||(t=document.createElement("link"),t.type="image/svg+xml",t.rel="icon",document.head.appendChild(t)),e instanceof SVGElement?t.href="data:image/svg+xml;utf8,"+e:t.href=e;},[e]);}function ge(e){useEffect(()=>{let t=document.querySelector('link[rel="apple-touch-icon"]');t||(t=document.createElement("link"),t.rel="apple-touch-icon",document.head.appendChild(t)),t.href=e;},[e]);}function we(){let[e,o]=S.useState(new Awaiting),t=S.useCallback(r=>navigator.clipboard&&navigator.clipboard.writeText(r).then(()=>{o(Success.of(r));}).catch(s=>{o(Failure.dueTo(s.message,s.name));}),[]);return [e,t]}function xe(e={}){let[o,t]=S.useState(new Awaiting),r=S.useRef(e);return S.useEffect(()=>{let s=({coords:i,timestamp:g})=>{t(Success.of({timestamp:g,latitude:i.latitude,longitude:i.longitude,altitude:i.altitude,accuracy:i.accuracy,altitudeAccuracy:i.altitudeAccuracy,heading:i.heading,speed:i.speed}));},n=i=>{t(Failure.dueTo(i.message,String(i.code)));},{enableHighAccuracy:u,timeout:c,maximumAge:a}=r.current;navigator.geolocation.getCurrentPosition(s,n,{enableHighAccuracy:u,timeout:c,maximumAge:a});let f=navigator.geolocation.watchPosition(s,n,{enableHighAccuracy:u,timeout:c,maximumAge:a});return ()=>{navigator.geolocation.clearWatch(f);}},[]),o}function Re(e=1e3*60){let[o,t]=S.useState(!1);return S.useEffect(()=>{let r,s=()=>{t(!0);},n=E(c=>{t(!1),window.clearTimeout(r),r=window.setTimeout(s,e);},500),u=c=>{document.hidden||n(c);};r=window.setTimeout(s,e),l("mousemove",n),l("mousedown",n),l("resize",n),l("keydown",n),l("touchstart",n),l("wheel",n),l("visibilitychange",u);},[e]),o}function m(e){let o=S.useCallback(s=>{let n=window.matchMedia(e);return n.addEventListener("change",s),()=>{n.removeEventListener("change",s);}},[e]),t=()=>window.matchMedia(e).matches,r=()=>{throw new Error("useMediaQuery is a client-only hook")};return S.useSyncExternalStore(o,t,r)}function L(){return m("(prefers-color-scheme: dark)")}function M(){return m("(prefers-contrast: more)")}function A(){return m("(prefers-contrast: less)")}function C(){return m("(prefers-reduced-motion: reduce)")}function I(){return m("(prefers-reduced-transparency: reduce)")}function Me(e,o={}){let[t,r]=S.useState(new Awaiting),s=S.useRef(o);return S.useEffect(()=>{let n=document.querySelector(`script[src="${e}"]`);if(n)switch(n.getAttribute("data-status")){case"ready":r(Success.of("ready"));break;case"error":r(Failure.dueTo(`Failed to load script: ${e}`,"error"));break;default:r(Success.of("external"));break}else if(n=document.createElement("script"),n){n.src=e,n.async=!0,document.body.appendChild(n);let u=()=>{n?.setAttribute("data-status","ready"),r(Success.of(!0)),a();},c=()=>{n?.setAttribute("data-status","error"),r(Failure.dueTo(`Failed to load script: ${e}`,"error")),a();},a=()=>{n?.removeEventListener("load",u),n?.removeEventListener("error",c);};n.addEventListener("load",u),n.addEventListener("error",c);let f=s.current.removeOnUnmount;return ()=>{f===!0&&(n?.remove(),a());}}else r(Failure.dueTo(`Failed to add script tag for : ${e}`,"error"));},[e]),t}function G(e,o,t,r){window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:o,oldValue:t,storageArea:r}));}var _=()=>{throw Error("this is a client-only hook")};function y(e,o){let t=o.getItem(e);if(!t)return Failure.dueTo(`${e} is not available in ${o} storage`,"NOT_AVAILABLE");try{let r=JSON.parse(t);return Success.of(r)}catch{return Failure.dueTo(`${e} has invalid format in storage`,"INVALID_FORMAT")}}function V(e,o,t){let r=y(e,t);try{let s=JSON.stringify(o);return t.setItem(e,s),G(e,o,r instanceof Failure?null:r.unwrap(),t),Success.of(o)}catch{return Failure.dueTo(`${o} has invalid format to put into storage`,"INVALID_FORMAT")}}function k(e,o){let t=y(e,o);if(t instanceof Failure)return o.removeItem(e),Success.of(e);try{return o.removeItem(e),G(e,null,t.unwrap(),o),Success.of(e)}catch{return Failure.dueTo(`${e} could not be removed from storage`,"INVALID_FORMAT")}}function Oe(e,o){return JSON.stringify(e)===JSON.stringify(o)}function Pe(e,o,t){let r=useCallback(()=>y(e,t),[e,t]),s=useRef(r()),n=useCallback(i=>(window.addEventListener("storage",i),()=>window.removeEventListener("storage",i)),[]),u=useCallback(()=>{let i=r();return (s.current===null||!Oe(s.current,i))&&(s.current=i),s.current},[r]),c=useSyncExternalStore(n,u,_),a=useCallback(i=>{let g=i;g===null?k(e,t):V(e,g,t);},[e,t]),f=useCallback(()=>{k(e,t);},[e,t]);return useEffect(()=>{V(e,o,t);},[e,o,t]),[c,a,f]}function De(){let[e,o]=S.useState({x:0,y:0}),t=S.useCallback((...r)=>{if(typeof r[0]=="object")window.scrollTo(r[0]);else if(typeof r[0]=="number"&&typeof r[1]=="number")window.scrollTo(r[0],r[1]);else throw new Error("Invalid arguments passed to scrollTo. See here for more info: https://developer.mozilla.org/en-US/docs/Web/API/Window/scrollTo")},[]);return S.useLayoutEffect(()=>{let r=()=>{o({x:window.scrollX,y:window.scrollY});};return r(),window.addEventListener("scroll",r),()=>{window.removeEventListener("scroll",r);}},[]),[e,t]}function Fe(e,o="0px"){let[t,r]=useState(!1);return useEffect(()=>{if(e.current==null)return;let s=new IntersectionObserver(([n])=>r(n.isIntersecting),{rootMargin:o});return s.observe(e.current),()=>{e.current!=null&&s.unobserve(e.current);}},[e.current,o]),t}var v=class{constructor(o,t,r,s,n){this.reducedMotion=o,this.highContrast=t,this.lowContrast=r,this.reducedTransparency=s,this.darkMode=n;}prefersDarkMode(){return this.darkMode}prefersHighContrast(){return this.highContrast}prefersLowContrast(){return this.lowContrast}prefersReducedMotion(){return this.reducedMotion}prefersTransparency(){return this.reducedTransparency}};var He=()=>{let e=C(),o=M(),t=A(),r=I(),s=L();return new v(e,o,t,r,s)};

export { v as BrowserAccessibilityPreferences, x as CookieStorage, ge as useAppleTouchFavicon, He as useBrowserAccessibilityPreferences, we as useCopyToClipboard, U as useDebounce, le as useDocumentTitle, l as useEventListener, xe as useGeolocation, ce as useHover, de as useIcoFavicon, Re as useIdle, se as useLockBodyScroll, oe as useLongPress, te as useMeasure, m as useMediaQuery, Fe as useOnScreen, L as usePrefersDarkMode, M as usePrefersHighContast, A as usePrefersLowContrast, C as usePrefersReducedMotion, I as usePrefersReducedTransparancy, Me as useScript, Pe as useStorage, pe as useSvgFavicon, E as useThrottle, ee as useViewportSize, re as useVisibilityChange, De as useWindowScroll };
//# sourceMappingURL=out.js.map
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9ob29rcy91c2UtZGVib3VuY2UudHMiLCIuLi9zcmMvaG9va3MvdXNlLXRyb3R0bGUudHMiLCIuLi9zcmMvaG9va3MvdXNlLXZpZXdwb3J0LXNpemUudHMiLCIuLi9zcmMvaG9va3MvdXNlLW1lYXN1cmUudHMiLCIuLi9zcmMvaG9va3MvdXNlLWxvbmctcHJlc3MudHMiLCIuLi9zcmMvaG9va3MvdXNlLXZpc2liaWxpdHktY2hhbmdlLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1sb2NrLWJvZHktc2Nyb2xsLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1ob3Zlci50cyIsIi4uL3NyYy9ob29rcy91c2UtZXZlbnQtbGlzdGVuZXIudHMiLCIuLi9zcmMvc3RvcmFnZS9jb29raWUudHMiLCIuLi9zcmMvaG9va3MvdXNlLWRvY3VtZW50LXRpdGxlLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1pY28tZmF2aWNvbi50cyIsIi4uL3NyYy9ob29rcy91c2Utc3ZnLWZhdmljb24udHMiLCIuLi9zcmMvaG9va3MvdXNlLWFwcGxlLXRvdWNoLWZhdmljb24udHMiLCIuLi9zcmMvaG9va3MvdXNlLWNvcHktdG8tY2xpcGJvYXJkLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1nZW9sb2NhdGlvbi50cyIsIi4uL3NyYy9ob29rcy91c2UtaWRsZS50cyIsIi4uL3NyYy9ob29rcy91c2UtbWVkaWEtcXVlcnkudHMiLCIuLi9zcmMvaG9va3MvdXNlLXByZWZlcnMtZGFyay1tb2RlLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1wcmVmZXJzLWhpZ2gtY29udGFzdC50cyIsIi4uL3NyYy9ob29rcy91c2UtcHJlZmVycy1sb3ctY29udHJhc3QudHMiLCIuLi9zcmMvaG9va3MvdXNlLXByZWZlcnMtcmVkdWNlZC1tb3Rpb24udHMiLCIuLi9zcmMvaG9va3MvdXNlLXByZWZlcnMtcmVkdWNlZC10cmFuc3BhcmFuY3kudHMiLCIuLi9zcmMvaG9va3MvdXNlLXNjcmlwdC50cyIsIi4uL3NyYy9ob29rcy91c2Utc3RvcmFnZS50cyIsIi4uL3NyYy9zdG9yYWdlL3N0b3JhZ2UudHMiLCIuLi9zcmMvaG9va3MvdXNlLXdpbmRvdy1zY3JvbGwudHMiLCIuLi9zcmMvaG9va3MvdXNlLW9uLXNjcmVlbi50cyIsIi4uL3NyYy9hY2Nlc3NpYmlsaXR5L3ByZWZlcmVuY2VzLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1hY2Nlc3NpYmlsaXR5LXByZWZlcmVuY2VzLnRzIl0sIm5hbWVzIjpbInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlRGVib3VuY2UiLCJ2YWx1ZSIsImRlbGF5IiwiZGVib3VuY2VkVmFsdWUiLCJzZXREZWJvdW5jZWRWYWx1ZSIsImhhbmRsZXIiLCJ1c2VSZWYiLCJ1c2VUaHJvdHRsZSIsImludGVydmFsIiwidGhyb3R0bGVkVmFsdWUiLCJzZXRUaHJvdHRsZWRWYWx1ZSIsImxhc3RVcGRhdGVkIiwibm93IiwiaWQiLCJ1c2VDYWxsYmFjayIsInVzZVZpZXdwb3J0U2l6ZSIsIndpbmRvd1NpemUiLCJzZXRXaW5kb3dTaXplIiwic2V0U2l6ZSIsIlJlYWN0IiwidXNlTWVhc3VyZSIsImRpbWVuc2lvbnMiLCJzZXREaW1lbnNpb25zIiwicHJldmlvdXNPYnNlcnZlciIsIm5vZGUiLCJvYnNlcnZlciIsImVudHJ5Iiwid2lkdGgiLCJoZWlnaHQiLCJpc01vdXNlRXZlbnQiLCJldmVudCIsImlzVG91Y2hFdmVudCIsInVzZUxvbmdQcmVzcyIsImNhbGxiYWNrIiwib3B0aW9ucyIsInRocmVzaG9sZCIsIm9uU3RhcnQiLCJvbkZpbmlzaCIsIm9uQ2FuY2VsIiwiaXNMb25nUHJlc3NBY3RpdmUiLCJpc1ByZXNzZWQiLCJ0aW1lcklkIiwic3RhcnQiLCJjYW5jZWwiLCJ1c2VWaXNpYmlsaXR5Q2hhbmdlIiwidXNlTGF5b3V0RWZmZWN0IiwidXNlTG9ja0JvZHlTY3JvbGwiLCJvcmlnaW5hbFN0eWxlIiwidXNlRXZlbnRMaXN0ZW5lciIsImV2ZW50VHlwZSIsImVsZW1lbnQiLCJjYWxsYmFja1JlZiIsImV2ZW50TGlzdGVuZXIiLCJ1c2VIb3ZlciIsInJlZiIsImhvdmVyZWQiLCJzZXRIb3ZlcmVkIiwiQ29va2llcyIsIkNvb2tpZVN0b3JhZ2UiLCJhbGxDb29raWVzIiwia2V5IiwiaW5kZXgiLCJrZXlzIiwidXNlRG9jdW1lbnRUaXRsZSIsInRpdGxlIiwidXNlSWNvRmF2aWNvbiIsImljbyIsImljb0xpbmsiLCJ1c2VTdmdGYXZpY29uIiwic3ZnIiwic3ZnTGluayIsInVzZUFwcGxlVG91Y2hGYXZpY29uIiwiYXBwbGVUb3VjaCIsImFwcGxlVG91Y2hMaW5rIiwiQXdhaXRpbmciLCJGYWlsdXJlIiwiU3VjY2VzcyIsInVzZUNvcHlUb0NsaXBib2FyZCIsImNvcGllZFRleHQiLCJzZXRDb3BpZWRUZXh0IiwiY29weVRvQ2xpcGJvYXJkIiwiZXJyb3IiLCJ1c2VHZW9sb2NhdGlvbiIsInN0YXRlIiwic2V0U3RhdGUiLCJvcHRpb25zUmVmIiwib25FdmVudCIsImNvb3JkcyIsInRpbWVzdGFtcCIsIm9uRXZlbnRFcnJvciIsImVuYWJsZUhpZ2hBY2N1cmFjeSIsInRpbWVvdXQiLCJtYXhpbXVtQWdlIiwid2F0Y2hJZCIsInVzZUlkbGUiLCJtcyIsImlkbGUiLCJzZXRJZGxlIiwidGltZW91dElkIiwiaGFuZGxlVGltZW91dCIsImhhbmRsZUV2ZW50IiwiZSIsImhhbmRsZVZpc2liaWxpdHlDaGFuZ2UiLCJ1c2VNZWRpYVF1ZXJ5IiwicXVlcnkiLCJzdWJzY3JpYmUiLCJtYXRjaE1lZGlhIiwiZ2V0U25hcHNob3QiLCJnZXRTZXJ2ZXJTbmFwc2hvdCIsInVzZVByZWZlcnNEYXJrTW9kZSIsInVzZVByZWZlcnNIaWdoQ29udGFzdCIsInVzZVByZWZlcnNMb3dDb250cmFzdCIsInVzZVByZWZlcnNSZWR1Y2VkTW90aW9uIiwidXNlUHJlZmVyc1JlZHVjZWRUcmFuc3BhcmFuY3kiLCJ1c2VTY3JpcHQiLCJzcmMiLCJzdGF0dXMiLCJzZXRTdGF0dXMiLCJzY3JpcHQiLCJoYW5kbGVTY3JpcHRMb2FkIiwiY2xlYW51cExpc3RlbmVycyIsImhhbmRsZVNjcmlwdEVycm9yIiwicmVtb3ZlT25Vbm1vdW50IiwidXNlU3luY0V4dGVybmFsU3RvcmUiLCJkaXNwYXRjaFN0b3JhZ2VFdmVudCIsIm5ld1ZhbHVlIiwib2xkVmFsdWUiLCJzdG9yYWdlQXJlYSIsImdldFN0b3JhZ2VTZXJ2ZXJTbmFwc2hvdCIsImdldFN0b3JhZ2VJdGVtIiwiaXRlbSIsIm9iamVjdCIsInNldFN0b3JhZ2VJdGVtIiwiY3VycmVudEl0ZW0iLCJyZW1vdmVTdG9yYWdlSXRlbSIsImRlZXBFcXVhbCIsIm9iajEiLCJvYmoyIiwidXNlU3RvcmFnZSIsImluaXRpYWxWYWx1ZSIsInByZXZpb3VzU25hcHNob3RSZWYiLCJnZXRTbmFwc2hvdFdpdGhDYWNoZSIsIm5ld1NuYXBzaG90Iiwic3RvcmVkIiwic2V0IiwibmV4dFN0YXRlIiwiY2xlYXIiLCJ1c2VXaW5kb3dTY3JvbGwiLCJzY3JvbGxUbyIsImFyZ3MiLCJoYW5kbGVTY3JvbGwiLCJ1c2VPblNjcmVlbiIsInJvb3RNYXJnaW4iLCJpc1Zpc2libGUiLCJzZXRJc1Zpc2libGUiLCJCcm93c2VyQWNjZXNzaWJpbGl0eVByZWZlcmVuY2VzIiwicmVkdWNlZE1vdGlvbiIsImhpZ2hDb250cmFzdCIsImxvd0NvbnRyYXN0IiwicmVkdWNlZFRyYW5zcGFyZW5jeSIsImRhcmtNb2RlIiwidXNlQnJvd3NlckFjY2Vzc2liaWxpdHlQcmVmZXJlbmNlcyIsImhhc1JlZHVjZWRNb3Rpb24iLCJoYXNIaWdoQ29udHJhc3QiLCJoYXNMb3dDb250cmFzdCIsImhhc1JlZHVjZWRUcmFuc3BhcmVuY3kiLCJoYXNEYXJrTW9kZSJdLCJtYXBwaW5ncyI6IkFBQUEsT0FBUyxZQUFBQSxFQUFVLGFBQUFDLE1BQWlCLFFBRTdCLFNBQVNDLEVBQWVDLEVBQVVDLEVBQWtCLENBQ3pELEdBQU0sQ0FBQ0MsRUFBZ0JDLENBQWlCLEVBQUlOLEVBQVlHLENBQUssRUFFN0QsT0FBQUYsRUFBVSxJQUFNLENBQ2QsSUFBTU0sRUFBVSxX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QUFnQyxDQUM5QixPQUFPLEtBQUssYUFDZCxDQUVBLHFCQUErQixDQUM3QixPQUFPLEtBQUssbUJBQ2QsQ0FDRixFQ2hDQSxJQUFNQyxHQUNKLElBQXVDLENBQ3JDLElBQU1DLEVBQW1CbEQsRUFBd0IsRUFDM0NtRCxFQUFrQnJELEVBQXNCLEVBQ3hDc0QsRUFBaUJyRCxFQUFzQixFQUN2Q3NELEVBQXlCcEQsRUFBOEIsRUFDdkRxRCxFQUFjekQsRUFBbUIsRUFFdkMsT0FBTyxJQUFJOEMsRUFDVE8sRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsQ0FDRixDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gXCJyZWFjdFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlRGVib3VuY2U8VD4odmFsdWU6IFQsIGRlbGF5OiBudW1iZXIpOiBUIHtcbiAgY29uc3QgW2RlYm91bmNlZFZhbHVlLCBzZXREZWJvdW5jZWRWYWx1ZV0gPSB1c2VTdGF0ZTxUPih2YWx1ZSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBoYW5kbGVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBzZXREZWJvdW5jZWRWYWx1ZSh2YWx1ZSk7XG4gICAgfSwgZGVsYXkpO1xuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGNsZWFyVGltZW91dChoYW5kbGVyKTtcbiAgICB9O1xuICB9LCBbdmFsdWUsIGRlbGF5XSk7XG5cbiAgcmV0dXJuIGRlYm91bmNlZFZhbHVlO1xufVxuIiwiaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSBcInJlYWN0XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VUaHJvdHRsZTxUPih2YWx1ZTogVCwgaW50ZXJ2YWw6IG51bWJlciA9IDUwMCk6IFQge1xuICBjb25zdCBbdGhyb3R0bGVkVmFsdWUsIHNldFRocm90dGxlZFZhbHVlXSA9IHVzZVN0YXRlPFQ+KHZhbHVlKTtcbiAgY29uc3QgbGFzdFVwZGF0ZWQgPSB1c2VSZWY8bnVtYmVyIHwgbnVsbD4obnVsbCk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuXG4gICAgaWYgKGxhc3RVcGRhdGVkLmN1cnJlbnQgJiYgbm93ID49IGxhc3RVcGRhdGVkLmN1cnJlbnQgKyBpbnRlcnZhbCkge1xuICAgICAgbGFzdFVwZGF0ZWQuY3VycmVudCA9IG5vdztcbiAgICAgIHNldFRocm90dGxlZFZhbHVlKHZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgaWQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGxhc3RVcGRhdGVkLmN1cnJlbnQgPSBub3c7XG4gICAgICAgIHNldFRocm90dGxlZFZhbHVlKHZhbHVlKTtcbiAgICAgIH0sIGludGVydmFsKTtcblxuICAgICAgcmV0dXJuICgpID0+IHdpbmRvdy5jbGVhclRpbWVvdXQoaWQpO1xuICAgIH1cbiAgfSwgW3ZhbHVlLCBpbnRlcnZhbF0pO1xuXG4gIHJldHVybiB0aHJvdHRsZWRWYWx1ZTtcbn1cbiIsImltcG9ydCB7IHVzZUNhbGxiYWNrLCB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VFdmVudExpc3RlbmVyIH0gZnJvbSBcIkAvaG9va3MvdXNlLWV2ZW50LWxpc3RlbmVyXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmlld3BvcnRTaXplIHtcbiAgd2lkdGg6IG51bWJlcjtcbiAgaGVpZ2h0OiBudW1iZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VWaWV3cG9ydFNpemUoKTogVmlld3BvcnRTaXplIHtcbiAgY29uc3QgW3dpbmRvd1NpemUsIHNldFdpbmRvd1NpemVdID0gdXNlU3RhdGU8Vmlld3BvcnRTaXplPih7XG4gICAgd2lkdGg6IDAsXG4gICAgaGVpZ2h0OiAwLFxuICB9KTtcblxuICBjb25zdCBzZXRTaXplID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHNldFdpbmRvd1NpemUoe1xuICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoIHx8IDAsXG4gICAgICBoZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodCB8fCAwLFxuICAgIH0pO1xuICB9LCBbXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBzZXRTaXplKCk7IC8vIEluaXRpYWwgc2l6ZSBvbiBtb3VudFxuICB9LCBbc2V0U2l6ZV0pO1xuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHNldFNpemUpO1xuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9yaWVudGF0aW9uY2hhbmdlXCIsIHNldFNpemUpO1xuXG4gIHJldHVybiB3aW5kb3dTaXplO1xufVxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlTWVhc3VyZSgpOiBbXG4gIChub2RlOiBFbGVtZW50KSA9PiB2b2lkLFxuICB7IHdpZHRoOiBudW1iZXI7IGhlaWdodDogbnVtYmVyIH0sXG5dIHtcbiAgY29uc3QgW2RpbWVuc2lvbnMsIHNldERpbWVuc2lvbnNdID0gUmVhY3QudXNlU3RhdGUoe1xuICAgIHdpZHRoOiAwLFxuICAgIGhlaWdodDogMCxcbiAgfSk7XG5cbiAgY29uc3QgcHJldmlvdXNPYnNlcnZlciA9IFJlYWN0LnVzZVJlZjxSZXNpemVPYnNlcnZlciB8IG51bGw+KG51bGwpO1xuXG4gIGNvbnN0IGN1c3RvbVJlZiA9IFJlYWN0LnVzZUNhbGxiYWNrKChub2RlOiBFbGVtZW50KSA9PiB7XG4gICAgaWYgKHByZXZpb3VzT2JzZXJ2ZXIuY3VycmVudCkge1xuICAgICAgcHJldmlvdXNPYnNlcnZlci5jdXJyZW50LmRpc2Nvbm5lY3QoKTtcbiAgICAgIHByZXZpb3VzT2JzZXJ2ZXIuY3VycmVudCA9IG51bGw7XG4gICAgfVxuXG4gICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcigoW2VudHJ5XSkgPT4ge1xuICAgICAgICBpZiAoZW50cnkgJiYgZW50cnkuYm9yZGVyQm94U2l6ZSkge1xuICAgICAgICAgIGNvbnN0IHsgaW5saW5lU2l6ZTogd2lkdGgsIGJsb2NrU2l6ZTogaGVpZ2h0IH0gPVxuICAgICAgICAgICAgZW50cnkuYm9yZGVyQm94U2l6ZVswXTtcbiAgICAgICAgICBzZXREaW1lbnNpb25zKHsgd2lkdGgsIGhlaWdodCB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIG9ic2VydmVyLm9ic2VydmUobm9kZSk7XG4gICAgICBwcmV2aW91c09ic2VydmVyLmN1cnJlbnQgPSBvYnNlcnZlcjtcbiAgICB9XG4gIH0sIFtdKTtcblxuICByZXR1cm4gW2N1c3RvbVJlZiwgZGltZW5zaW9uc107XG59XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5cbmZ1bmN0aW9uIGlzTW91c2VFdmVudChldmVudDogRXZlbnQpOiBldmVudCBpcyBNb3VzZUV2ZW50IHtcbiAgcmV0dXJuIFwiY2xpZW50WFwiIGluIGV2ZW50OyAvLyBDaGVja2luZyBmb3IgYSBwcm9wZXJ0eSBzcGVjaWZpYyB0byBNb3VzZUV2ZW50XG59XG5cbmZ1bmN0aW9uIGlzVG91Y2hFdmVudChldmVudDogRXZlbnQpOiBldmVudCBpcyBUb3VjaEV2ZW50IHtcbiAgcmV0dXJuIFwidG91Y2hlc1wiIGluIGV2ZW50OyAvLyBDaGVja2luZyBmb3IgYSBwcm9wZXJ0eSBzcGVjaWZpYyB0byBUb3VjaEV2ZW50XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VMb25nUHJlc3MoXG4gIGNhbGxiYWNrOiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkLFxuICBvcHRpb25zOiB7XG4gICAgdGhyZXNob2xkPzogbnVtYmVyO1xuICAgIG9uU3RhcnQ/OiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkO1xuICAgIG9uRmluaXNoPzogKGV2ZW50OiBFdmVudCkgPT4gdm9pZDtcbiAgICBvbkNhbmNlbD86IChldmVudDogRXZlbnQpID0+IHZvaWQ7XG4gIH0gPSB7fSxcbikge1xuICBjb25zdCB7IHRocmVzaG9sZCA9IDQwMCwgb25TdGFydCwgb25GaW5pc2gsIG9uQ2FuY2VsIH0gPSBvcHRpb25zO1xuICBjb25zdCBpc0xvbmdQcmVzc0FjdGl2ZSA9IFJlYWN0LnVzZVJlZihmYWxzZSk7XG4gIGNvbnN0IGlzUHJlc3NlZCA9IFJlYWN0LnVzZVJlZihmYWxzZSk7XG4gIGNvbnN0IHRpbWVySWQgPSBSZWFjdC51c2VSZWY8bnVtYmVyPigpO1xuXG4gIHJldHVybiBSZWFjdC51c2VNZW1vKCgpID0+IHtcbiAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG5cbiAgICBjb25zdCBzdGFydCA9IChldmVudDogRXZlbnQpID0+IHtcbiAgICAgIGlmICghaXNNb3VzZUV2ZW50KGV2ZW50KSAmJiAhaXNUb3VjaEV2ZW50KGV2ZW50KSkgcmV0dXJuO1xuXG4gICAgICBpZiAob25TdGFydCkge1xuICAgICAgICBvblN0YXJ0KGV2ZW50KTtcbiAgICAgIH1cblxuICAgICAgaXNQcmVzc2VkLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgdGltZXJJZC5jdXJyZW50ID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBjYWxsYmFjayhldmVudCk7XG4gICAgICAgIGlzTG9uZ1ByZXNzQWN0aXZlLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgfSwgdGhyZXNob2xkKTtcbiAgICB9O1xuXG4gICAgY29uc3QgY2FuY2VsID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuICAgICAgaWYgKCFpc01vdXNlRXZlbnQoZXZlbnQpICYmICFpc1RvdWNoRXZlbnQoZXZlbnQpKSByZXR1cm47XG5cbiAgICAgIGlmIChpc0xvbmdQcmVzc0FjdGl2ZS5jdXJyZW50KSB7XG4gICAgICAgIGlmIChvbkZpbmlzaCkge1xuICAgICAgICAgIG9uRmluaXNoKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChpc1ByZXNzZWQuY3VycmVudCkge1xuICAgICAgICBpZiAob25DYW5jZWwpIHtcbiAgICAgICAgICBvbkNhbmNlbChldmVudCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaXNMb25nUHJlc3NBY3RpdmUuY3VycmVudCA9IGZhbHNlO1xuICAgICAgaXNQcmVzc2VkLmN1cnJlbnQgPSBmYWxzZTtcblxuICAgICAgaWYgKHRpbWVySWQuY3VycmVudCkge1xuICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRpbWVySWQuY3VycmVudCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IG1vdXNlSGFuZGxlcnMgPSB7XG4gICAgICBvbk1vdXNlRG93bjogc3RhcnQsXG4gICAgICBvbk1vdXNlVXA6IGNhbmNlbCxcbiAgICAgIG9uTW91c2VMZWF2ZTogY2FuY2VsLFxuICAgIH07XG5cbiAgICBjb25zdCB0b3VjaEhhbmRsZXJzID0ge1xuICAgICAgb25Ub3VjaFN0YXJ0OiBzdGFydCxcbiAgICAgIG9uVG91Y2hFbmQ6IGNhbmNlbCxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm1vdXNlSGFuZGxlcnMsXG4gICAgICAuLi50b3VjaEhhbmRsZXJzLFxuICAgIH07XG4gIH0sIFtjYWxsYmFjaywgdGhyZXNob2xkLCBvbkNhbmNlbCwgb25GaW5pc2gsIG9uU3RhcnRdKTtcbn1cbiIsImV4cG9ydCBjb25zdCB1c2VWaXNpYmlsaXR5Q2hhbmdlID0gKGNhbGxiYWNrOiAoKSA9PiB2b2lkKSA9PiB7XG4gIC8vIEFkZCBldmVudCBsaXN0ZW5lciBmb3IgdmlzaWJpbGl0eSBjaGFuZ2VcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgY2FsbGJhY2spO1xuXG4gIC8vIENsZWFuIHVwIGJ5IHJlbW92aW5nIGV2ZW50IGxpc3RlbmVyIHdoZW4gY29tcG9uZW50IHVubW91bnRzXG4gIHJldHVybiAoKSA9PiB7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgY2FsbGJhY2spO1xuICB9O1xufTtcbiIsImltcG9ydCB7IHVzZUxheW91dEVmZmVjdCB9IGZyb20gXCJyZWFjdFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlTG9ja0JvZHlTY3JvbGwoKSB7XG4gIHVzZUxheW91dEVmZmVjdCgoKSA9PiB7XG4gICAgLy8gR2V0IG9yaWdpbmFsIGJvZHkgb3ZlcmZsb3dcbiAgICBjb25zdCBvcmlnaW5hbFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkub3ZlcmZsb3c7XG5cbiAgICAvLyBQcmV2ZW50IHNjcm9sbGluZyBvbiBtb3VudFxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xuXG4gICAgLy8gUmUtZW5hYmxlIHNjcm9sbGluZyB3aGVuIGNvbXBvbmVudCB1bm1vdW50c1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gb3JpZ2luYWxTdHlsZTtcbiAgICB9O1xuICB9LCBbXSk7IC8vIEVtcHR5IGRlcGVuZGVuY3kgYXJyYXkgZW5zdXJlcyBlZmZlY3QgaXMgb25seSBydW4gb24gbW91bnQgYW5kIHVubW91bnRcbn1cbiIsImltcG9ydCB7IHVzZVN0YXRlLCBSZWZPYmplY3QgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZUV2ZW50TGlzdGVuZXIgfSBmcm9tIFwiQC9ob29rcy91c2UtZXZlbnQtbGlzdGVuZXJcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUhvdmVyKFxuICByZWY6IFJlZk9iamVjdDxIVE1MRWxlbWVudCB8IFdpbmRvdyB8IERvY3VtZW50Pixcbik6IGJvb2xlYW4ge1xuICBjb25zdCBbaG92ZXJlZCwgc2V0SG92ZXJlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG5cbiAgaWYgKHJlZi5jdXJyZW50KSB7XG4gICAgdXNlRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCAoKSA9PiBzZXRIb3ZlcmVkKHRydWUpLCByZWYuY3VycmVudCk7XG4gICAgdXNlRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsICgpID0+IHNldEhvdmVyZWQoZmFsc2UpLCByZWYuY3VycmVudCk7XG4gIH1cblxuICByZXR1cm4gaG92ZXJlZDtcbn1cbiIsImltcG9ydCB7IHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSBcInJlYWN0XCI7XG5cbnR5cGUgRXZlbnRUeXBlID0ga2V5b2YgRG9jdW1lbnRFdmVudE1hcCB8IGtleW9mIFdpbmRvd0V2ZW50TWFwO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlRXZlbnRMaXN0ZW5lcihcbiAgZXZlbnRUeXBlOiBFdmVudFR5cGUsXG4gIGNhbGxiYWNrOiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkLFxuICBlbGVtZW50OiBIVE1MRWxlbWVudCB8IFdpbmRvdyB8IERvY3VtZW50ID0gd2luZG93LFxuKTogdm9pZCB7XG4gIGNvbnN0IGNhbGxiYWNrUmVmID0gdXNlUmVmKGNhbGxiYWNrKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNhbGxiYWNrUmVmLmN1cnJlbnQgPSBjYWxsYmFjaztcbiAgfSwgW2NhbGxiYWNrXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIWVsZW1lbnQpIHJldHVybjtcblxuICAgIGNvbnN0IGV2ZW50TGlzdGVuZXIgPSAoZXZlbnQ6IEV2ZW50KSA9PiBjYWxsYmFja1JlZi5jdXJyZW50KGV2ZW50KTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBldmVudExpc3RlbmVyKTtcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBldmVudExpc3RlbmVyKTtcbiAgICB9O1xuICB9LCBbZXZlbnRUeXBlLCBlbGVtZW50XSk7XG59XG4iLCJpbXBvcnQgQ29va2llcyBmcm9tIFwianMtY29va2llXCI7XG5cbmV4cG9ydCBjbGFzcyBDb29raWVTdG9yYWdlIGltcGxlbWVudHMgU3RvcmFnZSB7XG4gIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoQ29va2llcy5nZXQoKSkubGVuZ3RoO1xuICB9XG5cbiAgY2xlYXIoKTogdm9pZCB7XG4gICAgY29uc3QgYWxsQ29va2llcyA9IENvb2tpZXMuZ2V0KCk7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gYWxsQ29va2llcykge1xuICAgICAgQ29va2llcy5yZW1vdmUoa2V5KTtcbiAgICB9XG4gIH1cblxuICBnZXRJdGVtKGtleTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgY29uc3QgdmFsdWUgPSBDb29raWVzLmdldChrZXkpO1xuICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiBudWxsO1xuICB9XG5cbiAga2V5KGluZGV4OiBudW1iZXIpOiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoQ29va2llcy5nZXQoKSk7XG4gICAgcmV0dXJuIGtleXMubGVuZ3RoID4gaW5kZXggPyBrZXlzW2luZGV4XSA6IG51bGw7XG4gIH1cblxuICByZW1vdmVJdGVtKGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgQ29va2llcy5yZW1vdmUoa2V5KTtcbiAgfVxuXG4gIHNldEl0ZW0oa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBDb29raWVzLnNldChrZXksIHZhbHVlKTtcbiAgfVxuXG4gIC8vIE9wdGlvbmFsOiBJbXBsZW1lbnQgdG9TdHJpbmcoKSBtZXRob2QgZm9yIGRlYnVnZ2luZyBvciBsb2dnaW5nXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KENvb2tpZXMuZ2V0KCksIG51bGwsIDIpO1xuICB9XG59XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VEb2N1bWVudFRpdGxlKHRpdGxlOiBzdHJpbmcpIHtcbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBkb2N1bWVudC50aXRsZSA9IHRpdGxlO1xuICB9LCBbdGl0bGVdKTtcbn1cbiIsImltcG9ydCB7IHVzZUVmZmVjdCB9IGZyb20gXCJyZWFjdFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlSWNvRmF2aWNvbihcbiAgaWNvOiBzdHJpbmcsIC8vIDMyeDMyXG4pOiB2b2lkIHtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBRdWVyeSBmb3IgdGhlIGljbyBsaW5rXG4gICAgY29uc3QgaWNvUXVlcnkgPSAnbGlua1tyZWw9XCJpY29uXCJdOm5vdChbdHlwZT1cImltYWdlL3N2Zyt4bWxcIl0pJztcbiAgICBsZXQgaWNvTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTExpbmtFbGVtZW50PihpY29RdWVyeSk7XG4gICAgaWYgKCFpY29MaW5rKSB7XG4gICAgICBpY29MaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIik7XG4gICAgICBpY29MaW5rLnJlbCA9IFwiaWNvblwiO1xuICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChpY29MaW5rKTtcbiAgICB9XG5cbiAgICBpY29MaW5rLmhyZWYgPSBpY287XG4gIH0sIFtpY29dKTtcbn1cbiIsImltcG9ydCB7IHVzZUVmZmVjdCB9IGZyb20gXCJyZWFjdFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlU3ZnRmF2aWNvbihzdmc6IHN0cmluZyB8IFNWR0VsZW1lbnQpOiB2b2lkIHtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBRdWVyeSBmb3IgdGhlIFNWRyBpY29uIGxpbmtcbiAgICBjb25zdCBzdmdRdWVyeSA9ICdsaW5rW3JlbD1cImljb25cIl1bdHlwZT1cImltYWdlL3N2Zyt4bWxcIl0nO1xuICAgIGxldCBzdmdMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MTGlua0VsZW1lbnQ+KHN2Z1F1ZXJ5KTtcblxuICAgIGlmICghc3ZnTGluaykge1xuICAgICAgc3ZnTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaW5rXCIpO1xuICAgICAgc3ZnTGluay50eXBlID0gXCJpbWFnZS9zdmcreG1sXCI7XG4gICAgICBzdmdMaW5rLnJlbCA9IFwiaWNvblwiO1xuICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdmdMaW5rKTtcbiAgICB9XG5cbiAgICBpZiAoc3ZnIGluc3RhbmNlb2YgU1ZHRWxlbWVudCkge1xuICAgICAgc3ZnTGluay5ocmVmID0gXCJkYXRhOmltYWdlL3N2Zyt4bWw7dXRmOCxcIiArIHN2ZztcbiAgICB9IGVsc2Uge1xuICAgICAgc3ZnTGluay5ocmVmID0gc3ZnO1xuICAgIH1cbiAgfSwgW3N2Z10pO1xufVxuIiwiaW1wb3J0IHsgdXNlRWZmZWN0IH0gZnJvbSBcInJlYWN0XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VBcHBsZVRvdWNoRmF2aWNvbihcbiAgYXBwbGVUb3VjaDogc3RyaW5nLCAvLyAxODDDlzE4MFxuKTogdm9pZCB7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gUXVlcnkgZm9yIHRoZSBhcHBsZSB0b3VjaCBsaW5rXG4gICAgY29uc3QgYXBwbGVUb3VjaFF1ZXJ5ID0gJ2xpbmtbcmVsPVwiYXBwbGUtdG91Y2gtaWNvblwiXSc7XG4gICAgbGV0IGFwcGxlVG91Y2hMaW5rID1cbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTExpbmtFbGVtZW50PihhcHBsZVRvdWNoUXVlcnkpO1xuICAgIGlmICghYXBwbGVUb3VjaExpbmspIHtcbiAgICAgIGFwcGxlVG91Y2hMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIik7XG4gICAgICBhcHBsZVRvdWNoTGluay5yZWwgPSBcImFwcGxlLXRvdWNoLWljb25cIjtcbiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoYXBwbGVUb3VjaExpbmspO1xuICAgIH1cbiAgICBhcHBsZVRvdWNoTGluay5ocmVmID0gYXBwbGVUb3VjaDtcbiAgfSwgW2FwcGxlVG91Y2hdKTtcbn1cbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IEFzeW5jUmVzdWx0LCBBd2FpdGluZywgRmFpbHVyZSwgU3VjY2VzcyB9IGZyb20gXCJAdGFjdGljcy9qcy1tb25hZFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlQ29weVRvQ2xpcGJvYXJkKCk6IEFzeW5jUmVzdWx0PHN0cmluZz4ge1xuICBjb25zdCBbY29waWVkVGV4dCwgc2V0Q29waWVkVGV4dF0gPSBSZWFjdC51c2VTdGF0ZTxBc3luY1Jlc3VsdDxzdHJpbmc+PihcbiAgICBuZXcgQXdhaXRpbmcoKSxcbiAgKTtcblxuICBjb25zdCBjb3B5VG9DbGlwYm9hcmQgPSBSZWFjdC51c2VDYWxsYmFjaygodmFsdWU6IHN0cmluZykgPT4ge1xuICAgIHJldHVybiAoXG4gICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkICYmXG4gICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkXG4gICAgICAgIC53cml0ZVRleHQodmFsdWUpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBzZXRDb3BpZWRUZXh0KFN1Y2Nlc3Mub2YodmFsdWUpKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnJvcjogRE9NRXhjZXB0aW9uKSA9PiB7XG4gICAgICAgICAgc2V0Q29waWVkVGV4dChGYWlsdXJlLmR1ZVRvKGVycm9yLm1lc3NhZ2UsIGVycm9yLm5hbWUpKTtcbiAgICAgICAgfSlcbiAgICApO1xuICB9LCBbXSk7XG5cbiAgcmV0dXJuIFtjb3BpZWRUZXh0LCBjb3B5VG9DbGlwYm9hcmRdO1xufVxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgQXN5bmNSZXN1bHQsIEF3YWl0aW5nLCBGYWlsdXJlLCBTdWNjZXNzIH0gZnJvbSBcIkB0YWN0aWNzL2pzLW1vbmFkXCI7XG5cbmludGVyZmFjZSBHZW9sb2NhdGlvblN0YXRlIHtcbiAgYWNjdXJhY3k6IG51bWJlciB8IG51bGw7XG4gIGFsdGl0dWRlOiBudW1iZXIgfCBudWxsO1xuICBhbHRpdHVkZUFjY3VyYWN5OiBudW1iZXIgfCBudWxsO1xuICBoZWFkaW5nOiBudW1iZXIgfCBudWxsO1xuICBsYXRpdHVkZTogbnVtYmVyIHwgbnVsbDtcbiAgbG9uZ2l0dWRlOiBudW1iZXIgfCBudWxsO1xuICBzcGVlZDogbnVtYmVyIHwgbnVsbDtcbiAgdGltZXN0YW1wOiBudW1iZXIgfCBudWxsO1xufVxuXG5pbnRlcmZhY2UgR2VvbG9jYXRpb25PcHRpb25zIHtcbiAgZW5hYmxlSGlnaEFjY3VyYWN5PzogYm9vbGVhbjtcbiAgdGltZW91dD86IG51bWJlcjtcbiAgbWF4aW11bUFnZT86IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIFBvc2l0aW9uIHtcbiAgY29vcmRzOiB7XG4gICAgbGF0aXR1ZGU6IG51bWJlcjtcbiAgICBsb25naXR1ZGU6IG51bWJlcjtcbiAgICBhY2N1cmFjeTogbnVtYmVyO1xuICAgIGFsdGl0dWRlOiBudW1iZXIgfCBudWxsO1xuICAgIGFsdGl0dWRlQWNjdXJhY3k6IG51bWJlciB8IG51bGw7XG4gICAgaGVhZGluZzogbnVtYmVyIHwgbnVsbDtcbiAgICBzcGVlZDogbnVtYmVyIHwgbnVsbDtcbiAgfTtcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBQb3NpdGlvbkVycm9yIHtcbiAgY29kZTogbnVtYmVyO1xuICBtZXNzYWdlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VHZW9sb2NhdGlvbihcbiAgb3B0aW9uczogR2VvbG9jYXRpb25PcHRpb25zID0ge30sXG4pOiBBc3luY1Jlc3VsdDxHZW9sb2NhdGlvblN0YXRlPiB7XG4gIGNvbnN0IFtzdGF0ZSwgc2V0U3RhdGVdID0gUmVhY3QudXNlU3RhdGU8QXN5bmNSZXN1bHQ8R2VvbG9jYXRpb25TdGF0ZT4+KFxuICAgIG5ldyBBd2FpdGluZygpLFxuICApO1xuICBjb25zdCBvcHRpb25zUmVmID0gUmVhY3QudXNlUmVmPEdlb2xvY2F0aW9uT3B0aW9ucz4ob3B0aW9ucyk7XG5cbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBvbkV2ZW50ID0gKHsgY29vcmRzLCB0aW1lc3RhbXAgfTogUG9zaXRpb24pID0+IHtcbiAgICAgIHNldFN0YXRlKFxuICAgICAgICBTdWNjZXNzLm9mKHtcbiAgICAgICAgICB0aW1lc3RhbXAsXG4gICAgICAgICAgbGF0aXR1ZGU6IGNvb3Jkcy5sYXRpdHVkZSxcbiAgICAgICAgICBsb25naXR1ZGU6IGNvb3Jkcy5sb25naXR1ZGUsXG4gICAgICAgICAgYWx0aXR1ZGU6IGNvb3Jkcy5hbHRpdHVkZSxcbiAgICAgICAgICBhY2N1cmFjeTogY29vcmRzLmFjY3VyYWN5LFxuICAgICAgICAgIGFsdGl0dWRlQWNjdXJhY3k6IGNvb3Jkcy5hbHRpdHVkZUFjY3VyYWN5LFxuICAgICAgICAgIGhlYWRpbmc6IGNvb3Jkcy5oZWFkaW5nLFxuICAgICAgICAgIHNwZWVkOiBjb29yZHMuc3BlZWQsXG4gICAgICAgIH0pLFxuICAgICAgKTtcbiAgICB9O1xuXG4gICAgY29uc3Qgb25FdmVudEVycm9yID0gKGVycm9yOiBQb3NpdGlvbkVycm9yKSA9PiB7XG4gICAgICBzZXRTdGF0ZShGYWlsdXJlLmR1ZVRvKGVycm9yLm1lc3NhZ2UsIFN0cmluZyhlcnJvci5jb2RlKSkpO1xuICAgIH07XG5cbiAgICBjb25zdCB7IGVuYWJsZUhpZ2hBY2N1cmFjeSwgdGltZW91dCwgbWF4aW11bUFnZSB9ID0gb3B0aW9uc1JlZi5jdXJyZW50O1xuXG4gICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihvbkV2ZW50LCBvbkV2ZW50RXJyb3IsIHtcbiAgICAgIGVuYWJsZUhpZ2hBY2N1cmFjeSxcbiAgICAgIHRpbWVvdXQsXG4gICAgICBtYXhpbXVtQWdlLFxuICAgIH0pO1xuXG4gICAgY29uc3Qgd2F0Y2hJZCA9IG5hdmlnYXRvci5nZW9sb2NhdGlvbi53YXRjaFBvc2l0aW9uKG9uRXZlbnQsIG9uRXZlbnRFcnJvciwge1xuICAgICAgZW5hYmxlSGlnaEFjY3VyYWN5LFxuICAgICAgdGltZW91dCxcbiAgICAgIG1heGltdW1BZ2UsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmNsZWFyV2F0Y2god2F0Y2hJZCk7XG4gICAgfTtcbiAgfSwgW10pO1xuXG4gIHJldHVybiBzdGF0ZTtcbn1cbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZUV2ZW50TGlzdGVuZXIgfSBmcm9tIFwiQC9ob29rcy91c2UtZXZlbnQtbGlzdGVuZXJcIjtcbmltcG9ydCB7IHVzZVRocm90dGxlIH0gZnJvbSBcIkAvaG9va3MvdXNlLXRyb3R0bGVcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUlkbGUobXM6IG51bWJlciA9IDEwMDAgKiA2MCk6IGJvb2xlYW4ge1xuICBjb25zdCBbaWRsZSwgc2V0SWRsZV0gPSBSZWFjdC51c2VTdGF0ZTxib29sZWFuPihmYWxzZSk7XG5cbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBsZXQgdGltZW91dElkOiBudW1iZXI7XG5cbiAgICBjb25zdCBoYW5kbGVUaW1lb3V0ID0gKCkgPT4ge1xuICAgICAgc2V0SWRsZSh0cnVlKTtcbiAgICB9O1xuXG4gICAgY29uc3QgaGFuZGxlRXZlbnQgPSB1c2VUaHJvdHRsZSgoZTogRXZlbnQpID0+IHtcbiAgICAgIHNldElkbGUoZmFsc2UpO1xuXG4gICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICB0aW1lb3V0SWQgPSB3aW5kb3cuc2V0VGltZW91dChoYW5kbGVUaW1lb3V0LCBtcyk7XG4gICAgfSwgNTAwKTtcblxuICAgIGNvbnN0IGhhbmRsZVZpc2liaWxpdHlDaGFuZ2UgPSAoZTogRXZlbnQpID0+IHtcbiAgICAgIGlmICghZG9jdW1lbnQuaGlkZGVuKSB7XG4gICAgICAgIGhhbmRsZUV2ZW50KGUpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICB0aW1lb3V0SWQgPSB3aW5kb3cuc2V0VGltZW91dChoYW5kbGVUaW1lb3V0LCBtcyk7XG5cbiAgICB1c2VFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGhhbmRsZUV2ZW50KTtcbiAgICB1c2VFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZUV2ZW50KTtcbiAgICB1c2VFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIGhhbmRsZUV2ZW50KTtcbiAgICB1c2VFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFdmVudCk7XG4gICAgdXNlRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgaGFuZGxlRXZlbnQpO1xuICAgIHVzZUV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCBoYW5kbGVFdmVudCk7XG4gICAgdXNlRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgaGFuZGxlVmlzaWJpbGl0eUNoYW5nZSk7XG4gIH0sIFttc10pO1xuXG4gIHJldHVybiBpZGxlO1xufVxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlTWVkaWFRdWVyeShxdWVyeTogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGNvbnN0IHN1YnNjcmliZSA9IFJlYWN0LnVzZUNhbGxiYWNrKFxuICAgIChjYWxsYmFjazogKHRoaXM6IE1lZGlhUXVlcnlMaXN0LCBldjogTWVkaWFRdWVyeUxpc3RFdmVudCkgPT4gYW55KSA9PiB7XG4gICAgICBjb25zdCBtYXRjaE1lZGlhID0gd2luZG93Lm1hdGNoTWVkaWEocXVlcnkpO1xuXG4gICAgICBtYXRjaE1lZGlhLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgY2FsbGJhY2spO1xuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgbWF0Y2hNZWRpYS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGNhbGxiYWNrKTtcbiAgICAgIH07XG4gICAgfSxcbiAgICBbcXVlcnldLFxuICApO1xuXG4gIGNvbnN0IGdldFNuYXBzaG90ID0gKCk6IGJvb2xlYW4gPT4ge1xuICAgIHJldHVybiB3aW5kb3cubWF0Y2hNZWRpYShxdWVyeSkubWF0Y2hlcztcbiAgfTtcblxuICBjb25zdCBnZXRTZXJ2ZXJTbmFwc2hvdCA9ICgpOiBib29sZWFuID0+IHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJ1c2VNZWRpYVF1ZXJ5IGlzIGEgY2xpZW50LW9ubHkgaG9va1wiKTtcbiAgfTtcblxuICByZXR1cm4gUmVhY3QudXNlU3luY0V4dGVybmFsU3RvcmUoc3Vic2NyaWJlLCBnZXRTbmFwc2hvdCwgZ2V0U2VydmVyU25hcHNob3QpO1xufVxuIiwiaW1wb3J0IHsgdXNlTWVkaWFRdWVyeSB9IGZyb20gXCJAL2hvb2tzL3VzZS1tZWRpYS1xdWVyeVwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlUHJlZmVyc0RhcmtNb2RlKCk6IGJvb2xlYW4ge1xuICByZXR1cm4gdXNlTWVkaWFRdWVyeShcIihwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaylcIik7XG59XG4iLCJpbXBvcnQgeyB1c2VCcm93c2VyQWNjZXNzaWJpbGl0eVByZWZlcmVuY2VzIH0gZnJvbSBcIkAvaG9va3MvdXNlLWFjY2Vzc2liaWxpdHktcHJlZmVyZW5jZXNcIjtcbmltcG9ydCB7IHVzZU1lZGlhUXVlcnkgfSBmcm9tIFwiQC9ob29rcy91c2UtbWVkaWEtcXVlcnlcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVByZWZlcnNIaWdoQ29udGFzdCgpOiBib29sZWFuIHtcbiAgcmV0dXJuIHVzZU1lZGlhUXVlcnkoXCIocHJlZmVycy1jb250cmFzdDogbW9yZSlcIik7XG59XG4iLCJpbXBvcnQgeyB1c2VNZWRpYVF1ZXJ5IH0gZnJvbSBcIkAvaG9va3MvdXNlLW1lZGlhLXF1ZXJ5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VQcmVmZXJzTG93Q29udHJhc3QoKTogYm9vbGVhbiB7XG4gIHJldHVybiB1c2VNZWRpYVF1ZXJ5KFwiKHByZWZlcnMtY29udHJhc3Q6IGxlc3MpXCIpO1xufVxuIiwiaW1wb3J0IHsgdXNlTWVkaWFRdWVyeSB9IGZyb20gXCJAL2hvb2tzL3VzZS1tZWRpYS1xdWVyeVwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlUHJlZmVyc1JlZHVjZWRNb3Rpb24oKTogYm9vbGVhbiB7XG4gIHJldHVybiB1c2VNZWRpYVF1ZXJ5KFwiKHByZWZlcnMtcmVkdWNlZC1tb3Rpb246IHJlZHVjZSlcIik7XG59XG4iLCJpbXBvcnQgeyB1c2VCcm93c2VyQWNjZXNzaWJpbGl0eVByZWZlcmVuY2VzIH0gZnJvbSBcIkAvaG9va3MvdXNlLWFjY2Vzc2liaWxpdHktcHJlZmVyZW5jZXNcIjtcbmltcG9ydCB7IHVzZU1lZGlhUXVlcnkgfSBmcm9tIFwiQC9ob29rcy91c2UtbWVkaWEtcXVlcnlcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVByZWZlcnNSZWR1Y2VkVHJhbnNwYXJhbmN5KCk6IGJvb2xlYW4ge1xuICByZXR1cm4gdXNlTWVkaWFRdWVyeShcIihwcmVmZXJzLXJlZHVjZWQtdHJhbnNwYXJlbmN5OiByZWR1Y2UpXCIpO1xufVxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgQXN5bmNSZXN1bHQsIEF3YWl0aW5nLCBTdWNjZXNzLCBGYWlsdXJlIH0gZnJvbSBcIkB0YWN0aWNzL2pzLW1vbmFkXCI7XG5cbmludGVyZmFjZSBTY3JpcHRPcHRpb25zIHtcbiAgcmVtb3ZlT25Vbm1vdW50PzogYm9vbGVhbjtcbn1cblxudHlwZSBTdWNjZXNzUmVzcG9uc2UgPSBcInJlYWR5XCIgfCBcImV4dGVybmFsXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VTY3JpcHQoXG4gIHNyYzogc3RyaW5nLFxuICBvcHRpb25zOiBTY3JpcHRPcHRpb25zID0ge30sXG4pOiBBc3luY1Jlc3VsdDxTdWNjZXNzUmVzcG9uc2U+IHtcbiAgY29uc3QgW3N0YXR1cywgc2V0U3RhdHVzXSA9IFJlYWN0LnVzZVN0YXRlPEFzeW5jUmVzdWx0PGJvb2xlYW4+PihcbiAgICBuZXcgQXdhaXRpbmcoKSxcbiAgKTtcbiAgY29uc3Qgb3B0aW9uc1JlZiA9IFJlYWN0LnVzZVJlZjxTY3JpcHRPcHRpb25zPihvcHRpb25zKTtcblxuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGxldCBzY3JpcHQ6IEhUTUxTY3JpcHRFbGVtZW50IHwgbnVsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgc2NyaXB0W3NyYz1cIiR7c3JjfVwiXWAsXG4gICAgKTtcblxuICAgIGlmIChzY3JpcHQpIHtcbiAgICAgIC8vIFdoZW4gc3RhdHVzIGlzIG51bGwsIGEgc2NyaXB0IGlzIGV4dGVybmFsbHkgYWRkZWQgb3V0c2lkZSBvZiB0aGlzIGZ1bmN0aW9uLCB3ZSBhc3N1bWUgc3VjY2VzcyBhbmQgbWFyayBpdCBhcyBleHRlcm5hbFxuICAgICAgY29uc3QgZG9tU3RhdHVzID0gc2NyaXB0LmdldEF0dHJpYnV0ZShcImRhdGEtc3RhdHVzXCIpO1xuICAgICAgc3dpdGNoIChkb21TdGF0dXMpIHtcbiAgICAgICAgY2FzZSBcInJlYWR5XCI6XG4gICAgICAgICAgc2V0U3RhdHVzKFN1Y2Nlc3Mub2YoXCJyZWFkeVwiKSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJlcnJvclwiOlxuICAgICAgICAgIHNldFN0YXR1cyhGYWlsdXJlLmR1ZVRvKGBGYWlsZWQgdG8gbG9hZCBzY3JpcHQ6ICR7c3JjfWAsIFwiZXJyb3JcIikpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHNldFN0YXR1cyhTdWNjZXNzLm9mKFwiZXh0ZXJuYWxcIikpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO1xuICAgICAgaWYgKHNjcmlwdCkge1xuICAgICAgICBzY3JpcHQuc3JjID0gc3JjO1xuICAgICAgICBzY3JpcHQuYXN5bmMgPSB0cnVlO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNjcmlwdCk7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlU2NyaXB0TG9hZCA9ICgpID0+IHtcbiAgICAgICAgICBzY3JpcHQ/LnNldEF0dHJpYnV0ZShcImRhdGEtc3RhdHVzXCIsIFwicmVhZHlcIik7XG4gICAgICAgICAgc2V0U3RhdHVzKFN1Y2Nlc3Mub2YodHJ1ZSkpO1xuICAgICAgICAgIGNsZWFudXBMaXN0ZW5lcnMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBoYW5kbGVTY3JpcHRFcnJvciA9ICgpID0+IHtcbiAgICAgICAgICBzY3JpcHQ/LnNldEF0dHJpYnV0ZShcImRhdGEtc3RhdHVzXCIsIFwiZXJyb3JcIik7XG4gICAgICAgICAgc2V0U3RhdHVzKEZhaWx1cmUuZHVlVG8oYEZhaWxlZCB0byBsb2FkIHNjcmlwdDogJHtzcmN9YCwgXCJlcnJvclwiKSk7XG4gICAgICAgICAgY2xlYW51cExpc3RlbmVycygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGNsZWFudXBMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgICAgICAgc2NyaXB0Py5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZFwiLCBoYW5kbGVTY3JpcHRMb2FkKTtcbiAgICAgICAgICBzY3JpcHQ/LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBoYW5kbGVTY3JpcHRFcnJvcik7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2NyaXB0LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGhhbmRsZVNjcmlwdExvYWQpO1xuICAgICAgICBzY3JpcHQuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIGhhbmRsZVNjcmlwdEVycm9yKTtcblxuICAgICAgICBjb25zdCByZW1vdmVPblVubW91bnQgPSBvcHRpb25zUmVmLmN1cnJlbnQucmVtb3ZlT25Vbm1vdW50O1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgIGlmIChyZW1vdmVPblVubW91bnQgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHNjcmlwdD8ucmVtb3ZlKCk7XG4gICAgICAgICAgICBjbGVhbnVwTGlzdGVuZXJzKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0U3RhdHVzKFxuICAgICAgICAgIEZhaWx1cmUuZHVlVG8oYEZhaWxlZCB0byBhZGQgc2NyaXB0IHRhZyBmb3IgOiAke3NyY31gLCBcImVycm9yXCIpLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgfSwgW3NyY10pO1xuXG4gIHJldHVybiBzdGF0dXM7XG59XG4iLCJpbXBvcnQgUmVhY3QsIHtcbiAgdXNlQ2FsbGJhY2ssXG4gIHVzZUVmZmVjdCxcbiAgdXNlUmVmLFxuICB1c2VTeW5jRXh0ZXJuYWxTdG9yZSxcbn0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBSZXN1bHQgfSBmcm9tIFwiQHRhY3RpY3MvanMtbW9uYWRcIjtcbmltcG9ydCB7XG4gIGdldFN0b3JhZ2VJdGVtLFxuICBnZXRTdG9yYWdlU2VydmVyU25hcHNob3QsXG4gIHJlbW92ZVN0b3JhZ2VJdGVtLFxuICBzZXRTdG9yYWdlSXRlbSxcbn0gZnJvbSBcIkAvc3RvcmFnZS9zdG9yYWdlXCI7XG5pbXBvcnQgeyB1c2VFdmVudExpc3RlbmVyIH0gZnJvbSBcIkAvaG9va3MvdXNlLWV2ZW50LWxpc3RlbmVyXCI7XG5cbmZ1bmN0aW9uIGRlZXBFcXVhbChvYmoxOiBhbnksIG9iajI6IGFueSk6IGJvb2xlYW4ge1xuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqMSkgPT09IEpTT04uc3RyaW5naWZ5KG9iajIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXNlU3RvcmFnZTxUPihcbiAga2V5OiBzdHJpbmcsXG4gIGluaXRpYWxWYWx1ZTogVCxcbiAgc3RvcmFnZUFyZWE6IFN0b3JhZ2UsXG4pOiBbUmVzdWx0PFQ+LCAodmFsdWU6IFJlYWN0LlNldFN0YXRlQWN0aW9uPFQ+KSA9PiB2b2lkLCAoKSA9PiB2b2lkXSB7XG4gIC8vIE1lbW9pemUgdGhlIGdldFNuYXBzaG90IGZ1bmN0aW9uXG4gIGNvbnN0IGdldFNuYXBzaG90ID0gdXNlQ2FsbGJhY2soXG4gICAgKCkgPT4gZ2V0U3RvcmFnZUl0ZW08VD4oa2V5LCBzdG9yYWdlQXJlYSksXG4gICAgW2tleSwgc3RvcmFnZUFyZWFdLFxuICApO1xuXG4gIC8vIFVzZSBhIHJlZiB0byBjYWNoZSB0aGUgcHJldmlvdXMgcmVzdWx0IG9mIGdldFNuYXBzaG90XG4gIGNvbnN0IHByZXZpb3VzU25hcHNob3RSZWYgPSB1c2VSZWY8UmVzdWx0PFQ+PihnZXRTbmFwc2hvdCgpKTtcblxuICBjb25zdCBzdWJzY3JpYmUgPSB1c2VDYWxsYmFjaygoY2FsbGJhY2s6IChldmVudDogU3RvcmFnZUV2ZW50KSA9PiB2b2lkKSA9PiB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzdG9yYWdlXCIsIGNhbGxiYWNrKTtcbiAgICByZXR1cm4gKCkgPT4gd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdG9yYWdlXCIsIGNhbGxiYWNrKTtcbiAgfSwgW10pO1xuXG4gIC8vIENyZWF0ZSBhIHdyYXBwZXIgZnVuY3Rpb24gdG8gbWFuYWdlIHRoZSBjYWNoZWQgc25hcHNob3RcbiAgY29uc3QgZ2V0U25hcHNob3RXaXRoQ2FjaGUgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgY29uc3QgbmV3U25hcHNob3QgPSBnZXRTbmFwc2hvdCgpO1xuICAgIGlmIChcbiAgICAgIHByZXZpb3VzU25hcHNob3RSZWYuY3VycmVudCA9PT0gbnVsbCB8fFxuICAgICAgIWRlZXBFcXVhbChwcmV2aW91c1NuYXBzaG90UmVmLmN1cnJlbnQsIG5ld1NuYXBzaG90KSAvLyBOZWVkZWQgc2luY2Ugd2UgY3JlYXRlIG5ldyBvYmplY3RzIHdpdGggdGhlIHNhbWUgdmFsdWVcbiAgICApIHtcbiAgICAgIHByZXZpb3VzU25hcHNob3RSZWYuY3VycmVudCA9IG5ld1NuYXBzaG90O1xuICAgIH1cbiAgICByZXR1cm4gcHJldmlvdXNTbmFwc2hvdFJlZi5jdXJyZW50O1xuICB9LCBbZ2V0U25hcHNob3RdKTtcblxuICBjb25zdCBzdG9yZWQgPSB1c2VTeW5jRXh0ZXJuYWxTdG9yZShcbiAgICBzdWJzY3JpYmUsXG4gICAgZ2V0U25hcHNob3RXaXRoQ2FjaGUsXG4gICAgZ2V0U3RvcmFnZVNlcnZlclNuYXBzaG90LFxuICApO1xuXG4gIGNvbnN0IHNldCA9IHVzZUNhbGxiYWNrKFxuICAgICh2YWx1ZTogUmVhY3QuU2V0U3RhdGVBY3Rpb248VD4pID0+IHtcbiAgICAgIGNvbnN0IG5leHRTdGF0ZSA9IHZhbHVlO1xuICAgICAgaWYgKG5leHRTdGF0ZSA9PT0gbnVsbCkge1xuICAgICAgICByZW1vdmVTdG9yYWdlSXRlbShrZXksIHN0b3JhZ2VBcmVhKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldFN0b3JhZ2VJdGVtKGtleSwgbmV4dFN0YXRlLCBzdG9yYWdlQXJlYSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBba2V5LCBzdG9yYWdlQXJlYV0sXG4gICk7XG5cbiAgY29uc3QgY2xlYXIgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgcmVtb3ZlU3RvcmFnZUl0ZW0oa2V5LCBzdG9yYWdlQXJlYSk7XG4gIH0sIFtrZXksIHN0b3JhZ2VBcmVhXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBzZXRTdG9yYWdlSXRlbShrZXksIGluaXRpYWxWYWx1ZSwgc3RvcmFnZUFyZWEpO1xuICB9LCBba2V5LCBpbml0aWFsVmFsdWUsIHN0b3JhZ2VBcmVhXSk7XG5cbiAgcmV0dXJuIFtzdG9yZWQsIHNldCwgY2xlYXJdO1xufVxuIiwiaW1wb3J0IHsgRmFpbHVyZSwgUmVzdWx0LCBTdWNjZXNzIH0gZnJvbSBcIkB0YWN0aWNzL2pzLW1vbmFkXCI7XG5cbmV4cG9ydCBjb25zdCBlbnVtIFN0b3JhZ2VGYWlsdXJlcyB7XG4gIE5PVF9BVkFJTEFCTEUgPSBcIk5PVF9BVkFJTEFCTEVcIixcbiAgSU5WQUxJRF9GT1JNQVQgPSBcIklOVkFMSURfRk9STUFUXCIsXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkaXNwYXRjaFN0b3JhZ2VFdmVudChcbiAga2V5OiBzdHJpbmcsXG4gIG5ld1ZhbHVlOiBhbnksXG4gIG9sZFZhbHVlOiBhbnksXG4gIHN0b3JhZ2VBcmVhOiBTdG9yYWdlLFxuKSB7XG4gIHdpbmRvdy5kaXNwYXRjaEV2ZW50KFxuICAgIG5ldyBTdG9yYWdlRXZlbnQoXCJzdG9yYWdlXCIsIHsga2V5LCBuZXdWYWx1ZSwgb2xkVmFsdWUsIHN0b3JhZ2VBcmVhIH0pLFxuICApO1xufVxuXG5leHBvcnQgY29uc3QgZ2V0U3RvcmFnZVNlcnZlclNuYXBzaG90ID0gKCkgPT4ge1xuICB0aHJvdyBFcnJvcihcInRoaXMgaXMgYSBjbGllbnQtb25seSBob29rXCIpO1xufTtcblxuLy8gSGVscGVyIGZ1bmN0aW9ucyB0byBpbnRlcmFjdCB3aXRoIHNlc3Npb25TdG9yYWdlXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RvcmFnZUl0ZW08VD4oXG4gIGtleTogc3RyaW5nLFxuICBzdG9yYWdlQXJlYTogU3RvcmFnZSxcbik6IFJlc3VsdDxUPiB7XG4gIGNvbnN0IGl0ZW0gPSBzdG9yYWdlQXJlYS5nZXRJdGVtKGtleSk7XG4gIGlmICghaXRlbSkge1xuICAgIHJldHVybiBGYWlsdXJlLmR1ZVRvKFxuICAgICAgYCR7a2V5fSBpcyBub3QgYXZhaWxhYmxlIGluICR7c3RvcmFnZUFyZWF9IHN0b3JhZ2VgLFxuICAgICAgU3RvcmFnZUZhaWx1cmVzLk5PVF9BVkFJTEFCTEUsXG4gICAgKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3Qgb2JqZWN0ID0gSlNPTi5wYXJzZShpdGVtKTtcbiAgICByZXR1cm4gU3VjY2Vzcy5vZihvYmplY3QpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBGYWlsdXJlLmR1ZVRvKFxuICAgICAgYCR7a2V5fSBoYXMgaW52YWxpZCBmb3JtYXQgaW4gc3RvcmFnZWAsXG4gICAgICBTdG9yYWdlRmFpbHVyZXMuSU5WQUxJRF9GT1JNQVQsXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0U3RvcmFnZUl0ZW08VD4oXG4gIGtleTogc3RyaW5nLFxuICB2YWx1ZTogVCxcbiAgc3RvcmFnZUFyZWE6IFN0b3JhZ2UsXG4pOiBSZXN1bHQ8VD4ge1xuICBjb25zdCBjdXJyZW50SXRlbSA9IGdldFN0b3JhZ2VJdGVtKGtleSwgc3RvcmFnZUFyZWEpO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgaXRlbSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICBzdG9yYWdlQXJlYS5zZXRJdGVtKGtleSwgaXRlbSk7XG4gICAgZGlzcGF0Y2hTdG9yYWdlRXZlbnQoXG4gICAgICBrZXksXG4gICAgICB2YWx1ZSxcbiAgICAgIGN1cnJlbnRJdGVtIGluc3RhbmNlb2YgRmFpbHVyZSA/IG51bGwgOiBjdXJyZW50SXRlbS51bndyYXAoKSxcbiAgICAgIHN0b3JhZ2VBcmVhLFxuICAgICk7XG4gICAgcmV0dXJuIFN1Y2Nlc3Mub2YodmFsdWUpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBGYWlsdXJlLmR1ZVRvKFxuICAgICAgYCR7dmFsdWV9IGhhcyBpbnZhbGlkIGZvcm1hdCB0byBwdXQgaW50byBzdG9yYWdlYCxcbiAgICAgIFN0b3JhZ2VGYWlsdXJlcy5JTlZBTElEX0ZPUk1BVCxcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVTdG9yYWdlSXRlbShcbiAga2V5OiBzdHJpbmcsXG4gIHN0b3JhZ2VBcmVhOiBTdG9yYWdlLFxuKTogUmVzdWx0PHN0cmluZz4ge1xuICBjb25zdCBjdXJyZW50SXRlbSA9IGdldFN0b3JhZ2VJdGVtKGtleSwgc3RvcmFnZUFyZWEpO1xuICBpZiAoY3VycmVudEl0ZW0gaW5zdGFuY2VvZiBGYWlsdXJlKSB7XG4gICAgc3RvcmFnZUFyZWEucmVtb3ZlSXRlbShrZXkpO1xuICAgIHJldHVybiBTdWNjZXNzLm9mKGtleSk7XG4gIH1cblxuICB0cnkge1xuICAgIHN0b3JhZ2VBcmVhLnJlbW92ZUl0ZW0oa2V5KTtcbiAgICBkaXNwYXRjaFN0b3JhZ2VFdmVudChrZXksIG51bGwsIGN1cnJlbnRJdGVtLnVud3JhcCgpLCBzdG9yYWdlQXJlYSk7XG4gICAgcmV0dXJuIFN1Y2Nlc3Mub2Yoa2V5KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gRmFpbHVyZS5kdWVUbyhcbiAgICAgIGAke2tleX0gY291bGQgbm90IGJlIHJlbW92ZWQgZnJvbSBzdG9yYWdlYCxcbiAgICAgIFN0b3JhZ2VGYWlsdXJlcy5JTlZBTElEX0ZPUk1BVCxcbiAgICApO1xuICB9XG59XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2Nyb2xsU3RhdGUge1xuICB4OiBudW1iZXI7XG4gIHk6IG51bWJlcjtcbn1cblxuZXhwb3J0IHR5cGUgU2Nyb2xsVG9BcmdzID0gW29wdGlvbnM6IFNjcm9sbFRvT3B0aW9uc10gfCBbeDogbnVtYmVyLCB5OiBudW1iZXJdO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlV2luZG93U2Nyb2xsKCk6IFtcbiAgU2Nyb2xsU3RhdGUsXG4gICguLi5hcmdzOiBTY3JvbGxUb0FyZ3MpID0+IHZvaWQsXG5dIHtcbiAgY29uc3QgW3N0YXRlLCBzZXRTdGF0ZV0gPSBSZWFjdC51c2VTdGF0ZTxTY3JvbGxTdGF0ZT4oe1xuICAgIHg6IDAsXG4gICAgeTogMCxcbiAgfSk7XG5cbiAgY29uc3Qgc2Nyb2xsVG8gPSBSZWFjdC51c2VDYWxsYmFjaygoLi4uYXJnczogU2Nyb2xsVG9BcmdzKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBhcmdzWzBdID09PSBcIm9iamVjdFwiKSB7XG4gICAgICB3aW5kb3cuc2Nyb2xsVG8oYXJnc1swXSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYXJnc1swXSA9PT0gXCJudW1iZXJcIiAmJiB0eXBlb2YgYXJnc1sxXSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgd2luZG93LnNjcm9sbFRvKGFyZ3NbMF0sIGFyZ3NbMV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBJbnZhbGlkIGFyZ3VtZW50cyBwYXNzZWQgdG8gc2Nyb2xsVG8uIFNlZSBoZXJlIGZvciBtb3JlIGluZm86IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9XaW5kb3cvc2Nyb2xsVG9gLFxuICAgICAgKTtcbiAgICB9XG4gIH0sIFtdKTtcblxuICBSZWFjdC51c2VMYXlvdXRFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IGhhbmRsZVNjcm9sbCA9ICgpID0+IHtcbiAgICAgIHNldFN0YXRlKHsgeDogd2luZG93LnNjcm9sbFgsIHk6IHdpbmRvdy5zY3JvbGxZIH0pO1xuICAgIH07XG5cbiAgICBoYW5kbGVTY3JvbGwoKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBoYW5kbGVTY3JvbGwpO1xuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIGhhbmRsZVNjcm9sbCk7XG4gICAgfTtcbiAgfSwgW10pO1xuXG4gIHJldHVybiBbc3RhdGUsIHNjcm9sbFRvXTtcbn1cbiIsImltcG9ydCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUsIFJlZk9iamVjdCB9IGZyb20gXCJyZWFjdFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlT25TY3JlZW4oXG4gIHJlZjogUmVmT2JqZWN0PEVsZW1lbnQ+LFxuICByb290TWFyZ2luOiBzdHJpbmcgPSBcIjBweFwiLFxuKTogYm9vbGVhbiB7XG4gIGNvbnN0IFtpc1Zpc2libGUsIHNldElzVmlzaWJsZV0gPSB1c2VTdGF0ZShmYWxzZSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAocmVmLmN1cnJlbnQgPT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoXG4gICAgICAoW2VudHJ5XSkgPT4gc2V0SXNWaXNpYmxlKGVudHJ5LmlzSW50ZXJzZWN0aW5nKSxcbiAgICAgIHsgcm9vdE1hcmdpbiB9LFxuICAgICk7XG5cbiAgICBvYnNlcnZlci5vYnNlcnZlKHJlZi5jdXJyZW50KTtcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBpZiAocmVmLmN1cnJlbnQgPT0gbnVsbCkgcmV0dXJuO1xuICAgICAgb2JzZXJ2ZXIudW5vYnNlcnZlKHJlZi5jdXJyZW50KTtcbiAgICB9O1xuICB9LCBbcmVmLmN1cnJlbnQsIHJvb3RNYXJnaW5dKTtcblxuICByZXR1cm4gaXNWaXNpYmxlO1xufVxuIiwiZXhwb3J0IGNsYXNzIEJyb3dzZXJBY2Nlc3NpYmlsaXR5UHJlZmVyZW5jZXMge1xuICByZWFkb25seSByZWR1Y2VkTW90aW9uOiBib29sZWFuO1xuICByZWFkb25seSBoaWdoQ29udHJhc3Q6IGJvb2xlYW47XG4gIHJlYWRvbmx5IGxvd0NvbnRyYXN0OiBib29sZWFuO1xuICByZWFkb25seSByZWR1Y2VkVHJhbnNwYXJlbmN5OiBib29sZWFuO1xuICByZWFkb25seSBkYXJrTW9kZTogYm9vbGVhbjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICByZWR1Y2VkTW90aW9uOiBib29sZWFuLFxuICAgIGhpZ2hDb250cmFzdDogYm9vbGVhbixcbiAgICBsb3dDb250cmFzdDogYm9vbGVhbixcbiAgICByZWR1Y2VkVHJhbnNwYXJlbmN5OiBib29sZWFuLFxuICAgIGRhcmtNb2RlOiBib29sZWFuLFxuICApIHtcbiAgICB0aGlzLnJlZHVjZWRNb3Rpb24gPSByZWR1Y2VkTW90aW9uO1xuICAgIHRoaXMuaGlnaENvbnRyYXN0ID0gaGlnaENvbnRyYXN0O1xuICAgIHRoaXMubG93Q29udHJhc3QgPSBsb3dDb250cmFzdDtcbiAgICB0aGlzLnJlZHVjZWRUcmFuc3BhcmVuY3kgPSByZWR1Y2VkVHJhbnNwYXJlbmN5O1xuICAgIHRoaXMuZGFya01vZGUgPSBkYXJrTW9kZTtcbiAgfVxuXG4gIHByZWZlcnNEYXJrTW9kZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5kYXJrTW9kZTtcbiAgfVxuXG4gIHByZWZlcnNIaWdoQ29udHJhc3QoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaGlnaENvbnRyYXN0O1xuICB9XG5cbiAgcHJlZmVyc0xvd0NvbnRyYXN0KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmxvd0NvbnRyYXN0O1xuICB9XG5cbiAgcHJlZmVyc1JlZHVjZWRNb3Rpb24oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMucmVkdWNlZE1vdGlvbjtcbiAgfVxuXG4gIHByZWZlcnNUcmFuc3BhcmVuY3koKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMucmVkdWNlZFRyYW5zcGFyZW5jeTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgQnJvd3NlckFjY2Vzc2liaWxpdHlQcmVmZXJlbmNlcyB9IGZyb20gXCJAL2FjY2Vzc2liaWxpdHkvcHJlZmVyZW5jZXNcIjtcbmltcG9ydCB7IHVzZU1lZGlhUXVlcnkgfSBmcm9tIFwiQC9ob29rcy91c2UtbWVkaWEtcXVlcnlcIjtcbmltcG9ydCB7IHVzZVByZWZlcnNSZWR1Y2VkTW90aW9uIH0gZnJvbSBcIkAvaG9va3MvdXNlLXByZWZlcnMtcmVkdWNlZC1tb3Rpb25cIjtcbmltcG9ydCB7IHVzZVByZWZlcnNMb3dDb250cmFzdCB9IGZyb20gXCJAL2hvb2tzL3VzZS1wcmVmZXJzLWxvdy1jb250cmFzdFwiO1xuaW1wb3J0IHsgdXNlUHJlZmVyc0hpZ2hDb250YXN0IH0gZnJvbSBcIkAvaG9va3MvdXNlLXByZWZlcnMtaGlnaC1jb250YXN0XCI7XG5pbXBvcnQgeyB1c2VQcmVmZXJzUmVkdWNlZFRyYW5zcGFyYW5jeSB9IGZyb20gXCJAL2hvb2tzL3VzZS1wcmVmZXJzLXJlZHVjZWQtdHJhbnNwYXJhbmN5XCI7XG5pbXBvcnQgeyB1c2VQcmVmZXJzRGFya01vZGUgfSBmcm9tIFwiQC9ob29rcy91c2UtcHJlZmVycy1kYXJrLW1vZGVcIjtcblxuY29uc3QgdXNlQnJvd3NlckFjY2Vzc2liaWxpdHlQcmVmZXJlbmNlcyA9XG4gICgpOiBCcm93c2VyQWNjZXNzaWJpbGl0eVByZWZlcmVuY2VzID0+IHtcbiAgICBjb25zdCBoYXNSZWR1Y2VkTW90aW9uID0gdXNlUHJlZmVyc1JlZHVjZWRNb3Rpb24oKTtcbiAgICBjb25zdCBoYXNIaWdoQ29udHJhc3QgPSB1c2VQcmVmZXJzSGlnaENvbnRhc3QoKTtcbiAgICBjb25zdCBoYXNMb3dDb250cmFzdCA9IHVzZVByZWZlcnNMb3dDb250cmFzdCgpO1xuICAgIGNvbnN0IGhhc1JlZHVjZWRUcmFuc3BhcmVuY3kgPSB1c2VQcmVmZXJzUmVkdWNlZFRyYW5zcGFyYW5jeSgpO1xuICAgIGNvbnN0IGhhc0RhcmtNb2RlID0gdXNlUHJlZmVyc0RhcmtNb2RlKCk7XG5cbiAgICByZXR1cm4gbmV3IEJyb3dzZXJBY2Nlc3NpYmlsaXR5UHJlZmVyZW5jZXMoXG4gICAgICBoYXNSZWR1Y2VkTW90aW9uLFxuICAgICAgaGFzSGlnaENvbnRyYXN0LFxuICAgICAgaGFzTG93Q29udHJhc3QsXG4gICAgICBoYXNSZWR1Y2VkVHJhbnNwYXJlbmN5LFxuICAgICAgaGFzRGFya01vZGUsXG4gICAgKTtcbiAgfTtcblxuZXhwb3J0IHsgdXNlQnJvd3NlckFjY2Vzc2liaWxpdHlQcmVmZXJlbmNlcyB9O1xuIl19