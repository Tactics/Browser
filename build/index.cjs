'use strict';

var S = require('react');
var p = require('js-cookie');
var jsMonad = require('@tactics/js-monad');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var S__default = /*#__PURE__*/_interopDefault(S);
var p__default = /*#__PURE__*/_interopDefault(p);

function X(e,o){let[t,r]=S.useState(e);return S.useEffect(()=>{let s=setTimeout(()=>{r(e);},o);return ()=>{clearTimeout(s);}},[e,o]),t}function E(e,o=500){let[t,r]=S.useState(e),s=S.useRef(null);return S.useEffect(()=>{let n=Date.now();if(s.current&&n>=s.current+o)s.current=n,r(e);else {let u=window.setTimeout(()=>{s.current=n,r(e);},o);return ()=>window.clearTimeout(u)}},[e,o]),t}function a(e,o,t=window){let r=S.useRef(o);S.useEffect(()=>{r.current=o;},[o]),S.useEffect(()=>{if(!t)return;let s=n=>r.current(n);return t.addEventListener(e,s),()=>{t.removeEventListener(e,s);}},[e,t]);}function ne(){let[e,o]=S.useState({width:0,height:0}),t=S.useCallback(()=>{o({width:window.innerWidth||0,height:window.innerHeight||0});},[]);return S.useEffect(()=>{t();},[t]),a("resize",()=>t,window),a("orientationchange",()=>t,window),e}function se(){let[e,o]=S__default.default.useState({width:0,height:0}),t=S__default.default.useRef(null);return [S__default.default.useCallback(s=>{if(t.current&&(t.current.disconnect(),t.current=null),s.nodeType===Node.ELEMENT_NODE){let n=new ResizeObserver(([u])=>{if(u&&u.borderBoxSize){let{inlineSize:c,blockSize:l}=u.borderBoxSize[0];o({width:c,height:l});}});n.observe(s),t.current=n;}},[]),e]}function B(e){return "clientX"in e}function G(e){return "touches"in e}function ie(e,o={}){let{threshold:t=400,onStart:r,onFinish:s,onCancel:n}=o,u=S__default.default.useRef(!1),c=S__default.default.useRef(!1),l=S__default.default.useRef();return S__default.default.useMemo(()=>{if(typeof e!="function")return {};let f=d=>{!B(d)&&!G(d)||(r&&r(d),c.current=!0,l.current=window.setTimeout(()=>{e(d),u.current=!0;},t));},i=d=>{!B(d)&&!G(d)||(u.current?s&&s(d):c.current&&n&&n(d),u.current=!1,c.current=!1,l.current&&window.clearTimeout(l.current));};return {...{onMouseDown:f,onMouseUp:i,onMouseLeave:i},...{onTouchStart:f,onTouchEnd:i}}},[e,t,n,s,r])}var ue=e=>(document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e);});function ae(){S.useLayoutEffect(()=>{let e=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e;}},[]);}function me(e){let[o,t]=S.useState(!1);return e.current&&(a("mouseover",()=>t(!0),e.current),a("mouseout",()=>t(!1),e.current)),o}var x=class{get length(){return Object.keys(p__default.default.get()).length}clear(){let o=p__default.default.get();for(let t in o)p__default.default.remove(t);}getItem(o){let t=p__default.default.get(o);return t!==void 0?t:null}key(o){let t=Object.keys(p__default.default.get());return t.length>o?t[o]:null}removeItem(o){p__default.default.remove(o);}setItem(o,t){p__default.default.set(o,t);}toString(){return JSON.stringify(p__default.default.get(),null,2)}};function fe(e){S__default.default.useEffect(()=>{document.title=e;},[e]);}function R(e){S.useEffect(()=>{let t=document.querySelector('link[rel="apple-touch-icon"]');t||(t=document.createElement("link"),t.rel="apple-touch-icon",document.head.appendChild(t)),t.href=e;},[e]);}function L(e){S.useEffect(()=>{let t=document.querySelector('link[rel="icon"]:not([type="image/svg+xml"])');t||(t=document.createElement("link"),t.rel="icon",document.head.appendChild(t)),t.href=e;},[e]);}function M(e){S.useEffect(()=>{let t=document.querySelector('link[rel="icon"][type="image/svg+xml"]');t||(t=document.createElement("link"),t.type="image/svg+xml",t.rel="icon",document.head.appendChild(t)),e instanceof SVGElement?t.href="data:image/svg+xml;utf8,"+e:t.href=e;},[e]);}function be(e,o,t){S.useEffect(()=>{M(e),L(o),R(t);},[e,o,t]);}function Ee(){let[e,o]=S__default.default.useState(new jsMonad.Awaiting),t=S__default.default.useCallback(r=>navigator.clipboard&&navigator.clipboard.writeText(r).then(()=>{o(jsMonad.Success.of(r));}).catch(s=>{o(jsMonad.Failure.dueTo(s.message,s.name));}),[]);return [e,t]}function Le(e={}){let[o,t]=S__default.default.useState(new jsMonad.Awaiting),r=S__default.default.useRef(e);return S__default.default.useEffect(()=>{let s=({coords:i,timestamp:g})=>{t(jsMonad.Success.of({timestamp:g,latitude:i.latitude,longitude:i.longitude,altitude:i.altitude,accuracy:i.accuracy,altitudeAccuracy:i.altitudeAccuracy,heading:i.heading,speed:i.speed}));},n=i=>{t(jsMonad.Failure.dueTo(i.message,String(i.code)));},{enableHighAccuracy:u,timeout:c,maximumAge:l}=r.current;navigator.geolocation.getCurrentPosition(s,n,{enableHighAccuracy:u,timeout:c,maximumAge:l});let f=navigator.geolocation.watchPosition(s,n,{enableHighAccuracy:u,timeout:c,maximumAge:l});return ()=>{navigator.geolocation.clearWatch(f);}},[]),o}function Me(e=1e3*60){let[o,t]=S__default.default.useState(!1);return S__default.default.useEffect(()=>{let r,s=()=>{t(!0);},n=E(c=>{t(!1),window.clearTimeout(r),r=window.setTimeout(s,e);},500),u=c=>{document.hidden||n(c);};r=window.setTimeout(s,e),a("mousemove",n),a("mousedown",n),a("resize",n),a("keydown",n),a("touchstart",n),a("wheel",n),a("visibilitychange",u);},[e]),o}function m(e){let o=S__default.default.useCallback(s=>{let n=window.matchMedia(e);return n.addEventListener("change",s),()=>{n.removeEventListener("change",s);}},[e]),t=()=>window.matchMedia(e).matches,r=()=>{throw new Error("useMediaQuery is a client-only hook")};return S__default.default.useSyncExternalStore(o,t,r)}function C(){return m("(prefers-color-scheme: dark)")}function I(){return m("(prefers-contrast: more)")}function O(){return m("(prefers-contrast: less)")}function P(){return m("(prefers-reduced-motion: reduce)")}function F(){return m("(prefers-reduced-transparency: reduce)")}function Ce(e,o={}){let[t,r]=S__default.default.useState(new jsMonad.Awaiting),s=S__default.default.useRef(o);return S__default.default.useEffect(()=>{let n=document.querySelector(`script[src="${e}"]`);if(n)switch(n.getAttribute("data-status")){case"ready":r(jsMonad.Success.of("ready"));break;case"error":r(jsMonad.Failure.dueTo(`Failed to load script: ${e}`,"error"));break;default:r(jsMonad.Success.of("external"));break}else if(n=document.createElement("script"),n){n.src=e,n.async=!0,document.body.appendChild(n);let u=()=>{n?.setAttribute("data-status","ready"),r(jsMonad.Success.of(!0)),l();},c=()=>{n?.setAttribute("data-status","error"),r(jsMonad.Failure.dueTo(`Failed to load script: ${e}`,"error")),l();},l=()=>{n?.removeEventListener("load",u),n?.removeEventListener("error",c);};n.addEventListener("load",u),n.addEventListener("error",c);let f=s.current.removeOnUnmount;return ()=>{f===!0&&(n?.remove(),l());}}else r(jsMonad.Failure.dueTo(`Failed to add script tag for : ${e}`,"error"));},[e]),t}function j(e,o,t,r){window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:o,oldValue:t,storageArea:r}));}var U=()=>{throw Error("this is a client-only hook")};function y(e,o){let t=o.getItem(e);if(!t)return jsMonad.Failure.dueTo(`${e} is not available in ${o} storage`,"NOT_AVAILABLE");try{let r=JSON.parse(t);return jsMonad.Success.of(r)}catch{return jsMonad.Failure.dueTo(`${e} has invalid format in storage`,"INVALID_FORMAT")}}function H(e,o,t){let r=y(e,t);try{let s=JSON.stringify(o);return t.setItem(e,s),j(e,o,r instanceof jsMonad.Failure?null:r.unwrap(),t),jsMonad.Success.of(o)}catch{return jsMonad.Failure.dueTo(`${o} has invalid format to put into storage`,"INVALID_FORMAT")}}function z(e,o){let t=y(e,o);if(t instanceof jsMonad.Failure)return o.removeItem(e),jsMonad.Success.of(e);try{return o.removeItem(e),j(e,null,t.unwrap(),o),jsMonad.Success.of(e)}catch{return jsMonad.Failure.dueTo(`${e} could not be removed from storage`,"INVALID_FORMAT")}}function Fe(e,o){return JSON.stringify(e)===JSON.stringify(o)}function Ve(e,o,t){let r=S.useCallback(()=>y(e,t),[e,t]),s=S.useRef(r()),n=S.useCallback(i=>(window.addEventListener("storage",i),()=>window.removeEventListener("storage",i)),[]),u=S.useCallback(()=>{let i=r();return (s.current===null||!Fe(s.current,i))&&(s.current=i),s.current},[r]),c=S.useSyncExternalStore(n,u,U),l=S.useCallback(i=>{let g=i;g===null?z(e,t):H(e,g,t);},[e,t]),f=S.useCallback(()=>{z(e,t);},[e,t]);return S.useEffect(()=>{H(e,o,t);},[e,o,t]),[c,l,f]}function De(){let[e,o]=S__default.default.useState({x:0,y:0}),t=S__default.default.useCallback((...r)=>{if(typeof r[0]=="object")window.scrollTo(r[0]);else if(typeof r[0]=="number"&&typeof r[1]=="number")window.scrollTo(r[0],r[1]);else throw new Error("Invalid arguments passed to scrollTo. See here for more info: https://developer.mozilla.org/en-US/docs/Web/API/Window/scrollTo")},[]);return S__default.default.useLayoutEffect(()=>{let r=()=>{o({x:window.scrollX,y:window.scrollY});};return r(),window.addEventListener("scroll",r),()=>{window.removeEventListener("scroll",r);}},[]),[e,t]}function ze(e,o="0px"){let[t,r]=S.useState(!1);return S.useEffect(()=>{if(e.current==null)return;let s=new IntersectionObserver(([n])=>r(n.isIntersecting),{rootMargin:o});return s.observe(e.current),()=>{e.current!=null&&s.unobserve(e.current);}},[e.current,o]),t}var b=class{constructor(o,t,r,s,n){this.reducedMotion=o,this.highContrast=t,this.lowContrast=r,this.reducedTransparency=s,this.darkMode=n;}prefersDarkMode(){return this.darkMode}prefersHighContrast(){return this.highContrast}prefersLowContrast(){return this.lowContrast}prefersReducedMotion(){return this.reducedMotion}prefersTransparency(){return this.reducedTransparency}};var Qe=()=>{let e=P(),o=I(),t=O(),r=F(),s=C();return new b(e,o,t,r,s)};

exports.BrowserAccessibilityPreferences = b;
exports.CookieStorage = x;
exports.useAppleTouchFavicon = R;
exports.useBrowserAccessibilityPreferences = Qe;
exports.useCopyToClipboard = Ee;
exports.useDebounce = X;
exports.useDocumentTitle = fe;
exports.useEventListener = a;
exports.useFavicon = be;
exports.useGeolocation = Le;
exports.useHover = me;
exports.useIcoFavicon = L;
exports.useIdle = Me;
exports.useLockBodyScroll = ae;
exports.useLongPress = ie;
exports.useMeasure = se;
exports.useMediaQuery = m;
exports.useOnScreen = ze;
exports.usePrefersDarkMode = C;
exports.usePrefersHighContast = I;
exports.usePrefersLowContrast = O;
exports.usePrefersReducedMotion = P;
exports.usePrefersReducedTransparancy = F;
exports.useScript = Ce;
exports.useStorage = Ve;
exports.useSvgFavicon = M;
exports.useThrottle = E;
exports.useViewportSize = ne;
exports.useVisibilityChange = ue;
exports.useWindowScroll = De;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9ob29rcy91c2UtZGVib3VuY2UudHMiLCIuLi9zcmMvaG9va3MvdXNlLXRyb3R0bGUudHMiLCIuLi9zcmMvaG9va3MvdXNlLXZpZXdwb3J0LXNpemUudHMiLCIuLi9zcmMvaG9va3MvdXNlLWV2ZW50LWxpc3RlbmVyLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1tZWFzdXJlLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1sb25nLXByZXNzLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS12aXNpYmlsaXR5LWNoYW5nZS50cyIsIi4uL3NyYy9ob29rcy91c2UtbG9jay1ib2R5LXNjcm9sbC50cyIsIi4uL3NyYy9ob29rcy91c2UtaG92ZXIudHMiLCIuLi9zcmMvc3RvcmFnZS9jb29raWUudHMiLCIuLi9zcmMvaG9va3MvdXNlLWRvY3VtZW50LXRpdGxlLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1mYXZpY29uLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1hcHBsZS10b3VjaC1mYXZpY29uLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1pY28tZmF2aWNvbi50cyIsIi4uL3NyYy9ob29rcy91c2Utc3ZnLWZhdmljb24udHMiLCIuLi9zcmMvaG9va3MvdXNlLWNvcHktdG8tY2xpcGJvYXJkLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1nZW9sb2NhdGlvbi50cyIsIi4uL3NyYy9ob29rcy91c2UtaWRsZS50cyIsIi4uL3NyYy9ob29rcy91c2UtbWVkaWEtcXVlcnkudHMiLCIuLi9zcmMvaG9va3MvdXNlLXByZWZlcnMtZGFyay1tb2RlLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1wcmVmZXJzLWhpZ2gtY29udGFzdC50cyIsIi4uL3NyYy9ob29rcy91c2UtcHJlZmVycy1sb3ctY29udHJhc3QudHMiLCIuLi9zcmMvaG9va3MvdXNlLXByZWZlcnMtcmVkdWNlZC1tb3Rpb24udHMiLCIuLi9zcmMvaG9va3MvdXNlLXByZWZlcnMtcmVkdWNlZC10cmFuc3BhcmFuY3kudHMiLCIuLi9zcmMvaG9va3MvdXNlLXNjcmlwdC50cyIsIi4uL3NyYy9ob29rcy91c2Utc3RvcmFnZS50cyIsIi4uL3NyYy9zdG9yYWdlL3N0b3JhZ2UudHMiLCIuLi9zcmMvaG9va3MvdXNlLXdpbmRvdy1zY3JvbGwudHMiLCIuLi9zcmMvaG9va3MvdXNlLW9uLXNjcmVlbi50cyIsIi4uL3NyYy9hY2Nlc3NpYmlsaXR5L3ByZWZlcmVuY2VzLnRzIiwiLi4vc3JjL2hvb2tzL3VzZS1hY2Nlc3NpYmlsaXR5LXByZWZlcmVuY2VzLnRzIl0sIm5hbWVzIjpbInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlRGVib3VuY2UiLCJ2YWx1ZSIsImRlbGF5IiwiZGVib3VuY2VkVmFsdWUiLCJzZXREZWJvdW5jZWRWYWx1ZSIsImhhbmRsZXIiLCJ1c2VSZWYiLCJ1c2VUaHJvdHRsZSIsImludGVydmFsIiwidGhyb3R0bGVkVmFsdWUiLCJzZXRUaHJvdHRsZWRWYWx1ZSIsImxhc3RVcGRhdGVkIiwibm93IiwiaWQiLCJ1c2VDYWxsYmFjayIsInVzZUV2ZW50TGlzdGVuZXIiLCJldmVudFR5cGUiLCJjYWxsYmFjayIsImVsZW1lbnQiLCJjYWxsYmFja1JlZiIsImV2ZW50TGlzdGVuZXIiLCJldmVudCIsInVzZVZpZXdwb3J0U2l6ZSIsIndpbmRvd1NpemUiLCJzZXRXaW5kb3dTaXplIiwic2V0U2l6ZSIsIlJlYWN0IiwidXNlTWVhc3VyZSIsImRpbWVuc2lvbnMiLCJzZXREaW1lbnNpb25zIiwicHJldmlvdXNPYnNlcnZlciIsIm5vZGUiLCJvYnNlcnZlciIsImVudHJ5Iiwid2lkdGgiLCJoZWlnaHQiLCJpc01vdXNlRXZlbnQiLCJpc1RvdWNoRXZlbnQiLCJ1c2VMb25nUHJlc3MiLCJvcHRpb25zIiwidGhyZXNob2xkIiwib25TdGFydCIsIm9uRmluaXNoIiwib25DYW5jZWwiLCJpc0xvbmdQcmVzc0FjdGl2ZSIsImlzUHJlc3NlZCIsInRpbWVySWQiLCJzdGFydCIsImNhbmNlbCIsInVzZVZpc2liaWxpdHlDaGFuZ2UiLCJ1c2VMYXlvdXRFZmZlY3QiLCJ1c2VMb2NrQm9keVNjcm9sbCIsIm9yaWdpbmFsU3R5bGUiLCJ1c2VIb3ZlciIsInJlZiIsImhvdmVyZWQiLCJzZXRIb3ZlcmVkIiwiQ29va2llcyIsIkNvb2tpZVN0b3JhZ2UiLCJhbGxDb29raWVzIiwia2V5IiwiaW5kZXgiLCJrZXlzIiwidXNlRG9jdW1lbnRUaXRsZSIsInRpdGxlIiwidXNlQXBwbGVUb3VjaEZhdmljb24iLCJhcHBsZVRvdWNoIiwiYXBwbGVUb3VjaExpbmsiLCJ1c2VJY29GYXZpY29uIiwiaWNvIiwiaWNvTGluayIsInVzZVN2Z0Zhdmljb24iLCJzdmciLCJzdmdMaW5rIiwidXNlRmF2aWNvbiIsIkF3YWl0aW5nIiwiRmFpbHVyZSIsIlN1Y2Nlc3MiLCJ1c2VDb3B5VG9DbGlwYm9hcmQiLCJjb3BpZWRUZXh0Iiwic2V0Q29waWVkVGV4dCIsImNvcHlUb0NsaXBib2FyZCIsImVycm9yIiwidXNlR2VvbG9jYXRpb24iLCJzdGF0ZSIsInNldFN0YXRlIiwib3B0aW9uc1JlZiIsIm9uRXZlbnQiLCJjb29yZHMiLCJ0aW1lc3RhbXAiLCJvbkV2ZW50RXJyb3IiLCJlbmFibGVIaWdoQWNjdXJhY3kiLCJ0aW1lb3V0IiwibWF4aW11bUFnZSIsIndhdGNoSWQiLCJ1c2VJZGxlIiwibXMiLCJpZGxlIiwic2V0SWRsZSIsInRpbWVvdXRJZCIsImhhbmRsZVRpbWVvdXQiLCJoYW5kbGVFdmVudCIsImUiLCJoYW5kbGVWaXNpYmlsaXR5Q2hhbmdlIiwidXNlTWVkaWFRdWVyeSIsInF1ZXJ5Iiwic3Vic2NyaWJlIiwibWF0Y2hNZWRpYSIsImdldFNuYXBzaG90IiwiZ2V0U2VydmVyU25hcHNob3QiLCJ1c2VQcmVmZXJzRGFya01vZGUiLCJ1c2VQcmVmZXJzSGlnaENvbnRhc3QiLCJ1c2VQcmVmZXJzTG93Q29udHJhc3QiLCJ1c2VQcmVmZXJzUmVkdWNlZE1vdGlvbiIsInVzZVByZWZlcnNSZWR1Y2VkVHJhbnNwYXJhbmN5IiwidXNlU2NyaXB0Iiwic3JjIiwic3RhdHVzIiwic2V0U3RhdHVzIiwic2NyaXB0IiwiaGFuZGxlU2NyaXB0TG9hZCIsImNsZWFudXBMaXN0ZW5lcnMiLCJoYW5kbGVTY3JpcHRFcnJvciIsInJlbW92ZU9uVW5tb3VudCIsInVzZVN5bmNFeHRlcm5hbFN0b3JlIiwiZGlzcGF0Y2hTdG9yYWdlRXZlbnQiLCJuZXdWYWx1ZSIsIm9sZFZhbHVlIiwic3RvcmFnZUFyZWEiLCJnZXRTdG9yYWdlU2VydmVyU25hcHNob3QiLCJnZXRTdG9yYWdlSXRlbSIsIml0ZW0iLCJvYmplY3QiLCJzZXRTdG9yYWdlSXRlbSIsImN1cnJlbnRJdGVtIiwicmVtb3ZlU3RvcmFnZUl0ZW0iLCJkZWVwRXF1YWwiLCJvYmoxIiwib2JqMiIsInVzZVN0b3JhZ2UiLCJpbml0aWFsVmFsdWUiLCJwcmV2aW91c1NuYXBzaG90UmVmIiwiZ2V0U25hcHNob3RXaXRoQ2FjaGUiLCJuZXdTbmFwc2hvdCIsInN0b3JlZCIsInNldCIsIm5leHRTdGF0ZSIsImNsZWFyIiwidXNlV2luZG93U2Nyb2xsIiwic2Nyb2xsVG8iLCJhcmdzIiwiaGFuZGxlU2Nyb2xsIiwidXNlT25TY3JlZW4iLCJyb290TWFyZ2luIiwiaXNWaXNpYmxlIiwic2V0SXNWaXNpYmxlIiwiQnJvd3NlckFjY2Vzc2liaWxpdHlQcmVmZXJlbmNlcyIsInJlZHVjZWRNb3Rpb24iLCJoaWdoQ29udHJhc3QiLCJsb3dDb250cmFzdCIsInJlZHVjZWRUcmFuc3BhcmVuY3kiLCJkYXJrTW9kZSIsInVzZUJyb3dzZXJBY2Nlc3NpYmlsaXR5UHJlZmVyZW5jZXMiLCJoYXNSZWR1Y2VkTW90aW9uIiwiaGFzSGlnaENvbnRyYXN0IiwiaGFzTG93Q29udHJhc3QiLCJoYXNSZWR1Y2VkVHJhbnNwYXJlbmN5IiwiaGFzRGFya01vZGUiXSwibWFwcGluZ3MiOiJBQUFBLE9BQVMsWUFBQUEsRUFBVSxhQUFBQyxNQUFpQixRQUU3QixTQUFTQyxFQUFlQyxFQUFVQyxFQUFrQixDQUN6RCxHQUFNLENBQUNDLEVBQWdCQyxDQUFpQixFQUFJTixFQUFZRyxD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QUFOLEtBQXNDLENBTzNDLFlBQ0VDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0EsQ0FDQSxLQUFLLGNBQWdCSixFQUNyQixLQUFLLGFBQWVDLEVBQ3BCLEtBQUssWUFBY0MsRUFDbkIsS0FBSyxvQkFBc0JDLEVBQzNCLEtBQUssU0FBV0MsQ0FDbEIsQ0FFQSxpQkFBMkIsQ0FDekIsT0FBTyxLQUFLLFFBQ2QsQ0FFQSxxQkFBK0IsQ0FDN0IsT0FBTyxLQUFLLFlBQ2QsQ0FFQSxvQkFBOEIsQ0FDNUIsT0FBTyxLQUFLLFdBQ2QsQ0FFQSxzQkFBZ0MsQ0FDOUIsT0FBTyxLQUFLLGFBQ2QsQ0FFQSxxQkFBK0IsQ0FDN0IsT0FBTyxLQUFLLG1CQUNkLENBQ0YsRUNoQ0EsSUFBTUMsR0FDSixJQUF1QyxDQUNyQyxJQUFNQyxFQUFtQmxELEVBQXdCLEVBQzNDbUQsRUFBa0JyRCxFQUFzQixFQUN4Q3NELEVBQWlCckQsRUFBc0IsRUFDdkNzRCxFQUF5QnBELEVBQThCLEVBQ3ZEcUQsRUFBY3pELEVBQW1CLEVBRXZDLE9BQU8sSUFBSThDLEVBQ1RPLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLENBQ0YsQ0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZURlYm91bmNlPFQ+KHZhbHVlOiBULCBkZWxheTogbnVtYmVyKTogVCB7XG4gIGNvbnN0IFtkZWJvdW5jZWRWYWx1ZSwgc2V0RGVib3VuY2VkVmFsdWVdID0gdXNlU3RhdGU8VD4odmFsdWUpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgc2V0RGVib3VuY2VkVmFsdWUodmFsdWUpO1xuICAgIH0sIGRlbGF5KTtcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjbGVhclRpbWVvdXQoaGFuZGxlcik7XG4gICAgfTtcbiAgfSwgW3ZhbHVlLCBkZWxheV0pO1xuXG4gIHJldHVybiBkZWJvdW5jZWRWYWx1ZTtcbn1cbiIsImltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZVJlZiB9IGZyb20gXCJyZWFjdFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlVGhyb3R0bGU8VD4odmFsdWU6IFQsIGludGVydmFsOiBudW1iZXIgPSA1MDApOiBUIHtcbiAgY29uc3QgW3Rocm90dGxlZFZhbHVlLCBzZXRUaHJvdHRsZWRWYWx1ZV0gPSB1c2VTdGF0ZTxUPih2YWx1ZSk7XG4gIGNvbnN0IGxhc3RVcGRhdGVkID0gdXNlUmVmPG51bWJlciB8IG51bGw+KG51bGwpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcblxuICAgIGlmIChsYXN0VXBkYXRlZC5jdXJyZW50ICYmIG5vdyA+PSBsYXN0VXBkYXRlZC5jdXJyZW50ICsgaW50ZXJ2YWwpIHtcbiAgICAgIGxhc3RVcGRhdGVkLmN1cnJlbnQgPSBub3c7XG4gICAgICBzZXRUaHJvdHRsZWRWYWx1ZSh2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGlkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBsYXN0VXBkYXRlZC5jdXJyZW50ID0gbm93O1xuICAgICAgICBzZXRUaHJvdHRsZWRWYWx1ZSh2YWx1ZSk7XG4gICAgICB9LCBpbnRlcnZhbCk7XG5cbiAgICAgIHJldHVybiAoKSA9PiB3aW5kb3cuY2xlYXJUaW1lb3V0KGlkKTtcbiAgICB9XG4gIH0sIFt2YWx1ZSwgaW50ZXJ2YWxdKTtcblxuICByZXR1cm4gdGhyb3R0bGVkVmFsdWU7XG59XG4iLCJpbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlRXZlbnRMaXN0ZW5lciB9IGZyb20gXCJAL2hvb2tzL3VzZS1ldmVudC1saXN0ZW5lclwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZpZXdwb3J0U2l6ZSB7XG4gIHdpZHRoOiBudW1iZXI7XG4gIGhlaWdodDogbnVtYmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXNlVmlld3BvcnRTaXplKCk6IFZpZXdwb3J0U2l6ZSB7XG4gIGNvbnN0IFt3aW5kb3dTaXplLCBzZXRXaW5kb3dTaXplXSA9IHVzZVN0YXRlPFZpZXdwb3J0U2l6ZT4oe1xuICAgIHdpZHRoOiAwLFxuICAgIGhlaWdodDogMCxcbiAgfSk7XG5cbiAgY29uc3Qgc2V0U2l6ZSA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBzZXRXaW5kb3dTaXplKHtcbiAgICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCB8fCAwLFxuICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgMCxcbiAgICB9KTtcbiAgfSwgW10pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgc2V0U2l6ZSgpOyAvLyBJbml0aWFsIHNpemUgb24gbW91bnRcbiAgfSwgW3NldFNpemVdKTtcblxuICB1c2VFdmVudExpc3RlbmVyKFwicmVzaXplXCIsICgpID0+IHNldFNpemUsIHdpbmRvdyk7XG4gIHVzZUV2ZW50TGlzdGVuZXIoXCJvcmllbnRhdGlvbmNoYW5nZVwiLCAoKSA9PiBzZXRTaXplLCB3aW5kb3cpO1xuXG4gIHJldHVybiB3aW5kb3dTaXplO1xufVxuIiwiaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tIFwicmVhY3RcIjtcblxudHlwZSBFdmVudFR5cGUgPSBrZXlvZiBEb2N1bWVudEV2ZW50TWFwIHwga2V5b2YgV2luZG93RXZlbnRNYXA7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VFdmVudExpc3RlbmVyKFxuICBldmVudFR5cGU6IEV2ZW50VHlwZSxcbiAgY2FsbGJhY2s6IChldmVudDogRXZlbnQpID0+IHZvaWQsXG4gIGVsZW1lbnQ6IEhUTUxFbGVtZW50IHwgV2luZG93IHwgRG9jdW1lbnQgPSB3aW5kb3csXG4pOiB2b2lkIHtcbiAgY29uc3QgY2FsbGJhY2tSZWYgPSB1c2VSZWYoY2FsbGJhY2spO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY2FsbGJhY2tSZWYuY3VycmVudCA9IGNhbGxiYWNrO1xuICB9LCBbY2FsbGJhY2tdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghZWxlbWVudCkgcmV0dXJuO1xuXG4gICAgY29uc3QgZXZlbnRMaXN0ZW5lciA9IChldmVudDogRXZlbnQpID0+IGNhbGxiYWNrUmVmLmN1cnJlbnQoZXZlbnQpO1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGV2ZW50TGlzdGVuZXIpO1xuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGV2ZW50TGlzdGVuZXIpO1xuICAgIH07XG4gIH0sIFtldmVudFR5cGUsIGVsZW1lbnRdKTtcbn1cbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZU1lYXN1cmUoKTogW1xuICAobm9kZTogRWxlbWVudCkgPT4gdm9pZCxcbiAgeyB3aWR0aDogbnVtYmVyOyBoZWlnaHQ6IG51bWJlciB9LFxuXSB7XG4gIGNvbnN0IFtkaW1lbnNpb25zLCBzZXREaW1lbnNpb25zXSA9IFJlYWN0LnVzZVN0YXRlKHtcbiAgICB3aWR0aDogMCxcbiAgICBoZWlnaHQ6IDAsXG4gIH0pO1xuXG4gIGNvbnN0IHByZXZpb3VzT2JzZXJ2ZXIgPSBSZWFjdC51c2VSZWY8UmVzaXplT2JzZXJ2ZXIgfCBudWxsPihudWxsKTtcblxuICBjb25zdCBjdXN0b21SZWYgPSBSZWFjdC51c2VDYWxsYmFjaygobm9kZTogRWxlbWVudCkgPT4ge1xuICAgIGlmIChwcmV2aW91c09ic2VydmVyLmN1cnJlbnQpIHtcbiAgICAgIHByZXZpb3VzT2JzZXJ2ZXIuY3VycmVudC5kaXNjb25uZWN0KCk7XG4gICAgICBwcmV2aW91c09ic2VydmVyLmN1cnJlbnQgPSBudWxsO1xuICAgIH1cblxuICAgIGlmIChub2RlLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSkge1xuICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKFtlbnRyeV0pID0+IHtcbiAgICAgICAgaWYgKGVudHJ5ICYmIGVudHJ5LmJvcmRlckJveFNpemUpIHtcbiAgICAgICAgICBjb25zdCB7IGlubGluZVNpemU6IHdpZHRoLCBibG9ja1NpemU6IGhlaWdodCB9ID1cbiAgICAgICAgICAgIGVudHJ5LmJvcmRlckJveFNpemVbMF07XG4gICAgICAgICAgc2V0RGltZW5zaW9ucyh7IHdpZHRoLCBoZWlnaHQgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBvYnNlcnZlci5vYnNlcnZlKG5vZGUpO1xuICAgICAgcHJldmlvdXNPYnNlcnZlci5jdXJyZW50ID0gb2JzZXJ2ZXI7XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgcmV0dXJuIFtjdXN0b21SZWYsIGRpbWVuc2lvbnNdO1xufVxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuXG5mdW5jdGlvbiBpc01vdXNlRXZlbnQoZXZlbnQ6IEV2ZW50KTogZXZlbnQgaXMgTW91c2VFdmVudCB7XG4gIHJldHVybiBcImNsaWVudFhcIiBpbiBldmVudDsgLy8gQ2hlY2tpbmcgZm9yIGEgcHJvcGVydHkgc3BlY2lmaWMgdG8gTW91c2VFdmVudFxufVxuXG5mdW5jdGlvbiBpc1RvdWNoRXZlbnQoZXZlbnQ6IEV2ZW50KTogZXZlbnQgaXMgVG91Y2hFdmVudCB7XG4gIHJldHVybiBcInRvdWNoZXNcIiBpbiBldmVudDsgLy8gQ2hlY2tpbmcgZm9yIGEgcHJvcGVydHkgc3BlY2lmaWMgdG8gVG91Y2hFdmVudFxufVxuXG5leHBvcnQgZnVuY3Rpb24gdXNlTG9uZ1ByZXNzKFxuICBjYWxsYmFjazogKGV2ZW50OiBFdmVudCkgPT4gdm9pZCxcbiAgb3B0aW9uczoge1xuICAgIHRocmVzaG9sZD86IG51bWJlcjtcbiAgICBvblN0YXJ0PzogKGV2ZW50OiBFdmVudCkgPT4gdm9pZDtcbiAgICBvbkZpbmlzaD86IChldmVudDogRXZlbnQpID0+IHZvaWQ7XG4gICAgb25DYW5jZWw/OiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkO1xuICB9ID0ge30sXG4pIHtcbiAgY29uc3QgeyB0aHJlc2hvbGQgPSA0MDAsIG9uU3RhcnQsIG9uRmluaXNoLCBvbkNhbmNlbCB9ID0gb3B0aW9ucztcbiAgY29uc3QgaXNMb25nUHJlc3NBY3RpdmUgPSBSZWFjdC51c2VSZWYoZmFsc2UpO1xuICBjb25zdCBpc1ByZXNzZWQgPSBSZWFjdC51c2VSZWYoZmFsc2UpO1xuICBjb25zdCB0aW1lcklkID0gUmVhY3QudXNlUmVmPG51bWJlcj4oKTtcblxuICByZXR1cm4gUmVhY3QudXNlTWVtbygoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgY29uc3Qgc3RhcnQgPSAoZXZlbnQ6IEV2ZW50KSA9PiB7XG4gICAgICBpZiAoIWlzTW91c2VFdmVudChldmVudCkgJiYgIWlzVG91Y2hFdmVudChldmVudCkpIHJldHVybjtcblxuICAgICAgaWYgKG9uU3RhcnQpIHtcbiAgICAgICAgb25TdGFydChldmVudCk7XG4gICAgICB9XG5cbiAgICAgIGlzUHJlc3NlZC5jdXJyZW50ID0gdHJ1ZTtcbiAgICAgIHRpbWVySWQuY3VycmVudCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY2FsbGJhY2soZXZlbnQpO1xuICAgICAgICBpc0xvbmdQcmVzc0FjdGl2ZS5jdXJyZW50ID0gdHJ1ZTtcbiAgICAgIH0sIHRocmVzaG9sZCk7XG4gICAgfTtcblxuICAgIGNvbnN0IGNhbmNlbCA9IChldmVudDogRXZlbnQpID0+IHtcbiAgICAgIGlmICghaXNNb3VzZUV2ZW50KGV2ZW50KSAmJiAhaXNUb3VjaEV2ZW50KGV2ZW50KSkgcmV0dXJuO1xuXG4gICAgICBpZiAoaXNMb25nUHJlc3NBY3RpdmUuY3VycmVudCkge1xuICAgICAgICBpZiAob25GaW5pc2gpIHtcbiAgICAgICAgICBvbkZpbmlzaChldmVudCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoaXNQcmVzc2VkLmN1cnJlbnQpIHtcbiAgICAgICAgaWYgKG9uQ2FuY2VsKSB7XG4gICAgICAgICAgb25DYW5jZWwoZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlzTG9uZ1ByZXNzQWN0aXZlLmN1cnJlbnQgPSBmYWxzZTtcbiAgICAgIGlzUHJlc3NlZC5jdXJyZW50ID0gZmFsc2U7XG5cbiAgICAgIGlmICh0aW1lcklkLmN1cnJlbnQpIHtcbiAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aW1lcklkLmN1cnJlbnQpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCBtb3VzZUhhbmRsZXJzID0ge1xuICAgICAgb25Nb3VzZURvd246IHN0YXJ0LFxuICAgICAgb25Nb3VzZVVwOiBjYW5jZWwsXG4gICAgICBvbk1vdXNlTGVhdmU6IGNhbmNlbCxcbiAgICB9O1xuXG4gICAgY29uc3QgdG91Y2hIYW5kbGVycyA9IHtcbiAgICAgIG9uVG91Y2hTdGFydDogc3RhcnQsXG4gICAgICBvblRvdWNoRW5kOiBjYW5jZWwsXG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAuLi5tb3VzZUhhbmRsZXJzLFxuICAgICAgLi4udG91Y2hIYW5kbGVycyxcbiAgICB9O1xuICB9LCBbY2FsbGJhY2ssIHRocmVzaG9sZCwgb25DYW5jZWwsIG9uRmluaXNoLCBvblN0YXJ0XSk7XG59XG4iLCJleHBvcnQgY29uc3QgdXNlVmlzaWJpbGl0eUNoYW5nZSA9IChjYWxsYmFjazogKCkgPT4gdm9pZCkgPT4ge1xuICAvLyBBZGQgZXZlbnQgbGlzdGVuZXIgZm9yIHZpc2liaWxpdHkgY2hhbmdlXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsIGNhbGxiYWNrKTtcblxuICAvLyBDbGVhbiB1cCBieSByZW1vdmluZyBldmVudCBsaXN0ZW5lciB3aGVuIGNvbXBvbmVudCB1bm1vdW50c1xuICByZXR1cm4gKCkgPT4ge1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsIGNhbGxiYWNrKTtcbiAgfTtcbn07XG4iLCJpbXBvcnQgeyB1c2VMYXlvdXRFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUxvY2tCb2R5U2Nyb2xsKCkge1xuICB1c2VMYXlvdXRFZmZlY3QoKCkgPT4ge1xuICAgIC8vIEdldCBvcmlnaW5hbCBib2R5IG92ZXJmbG93XG4gICAgY29uc3Qgb3JpZ2luYWxTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLm92ZXJmbG93O1xuXG4gICAgLy8gUHJldmVudCBzY3JvbGxpbmcgb24gbW91bnRcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcblxuICAgIC8vIFJlLWVuYWJsZSBzY3JvbGxpbmcgd2hlbiBjb21wb25lbnQgdW5tb3VudHNcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IG9yaWdpbmFsU3R5bGU7XG4gICAgfTtcbiAgfSwgW10pOyAvLyBFbXB0eSBkZXBlbmRlbmN5IGFycmF5IGVuc3VyZXMgZWZmZWN0IGlzIG9ubHkgcnVuIG9uIG1vdW50IGFuZCB1bm1vdW50XG59XG4iLCJpbXBvcnQgeyB1c2VTdGF0ZSwgUmVmT2JqZWN0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VFdmVudExpc3RlbmVyIH0gZnJvbSBcIkAvaG9va3MvdXNlLWV2ZW50LWxpc3RlbmVyXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VIb3ZlcihcbiAgcmVmOiBSZWZPYmplY3Q8SFRNTEVsZW1lbnQgfCBXaW5kb3cgfCBEb2N1bWVudD4sXG4pOiBib29sZWFuIHtcbiAgY29uc3QgW2hvdmVyZWQsIHNldEhvdmVyZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIGlmIChyZWYuY3VycmVudCkge1xuICAgIHVzZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgKCkgPT4gc2V0SG92ZXJlZCh0cnVlKSwgcmVmLmN1cnJlbnQpO1xuICAgIHVzZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW91dFwiLCAoKSA9PiBzZXRIb3ZlcmVkKGZhbHNlKSwgcmVmLmN1cnJlbnQpO1xuICB9XG5cbiAgcmV0dXJuIGhvdmVyZWQ7XG59XG4iLCJpbXBvcnQgQ29va2llcyBmcm9tIFwianMtY29va2llXCI7XG5cbmV4cG9ydCBjbGFzcyBDb29raWVTdG9yYWdlIGltcGxlbWVudHMgU3RvcmFnZSB7XG4gIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoQ29va2llcy5nZXQoKSkubGVuZ3RoO1xuICB9XG5cbiAgY2xlYXIoKTogdm9pZCB7XG4gICAgY29uc3QgYWxsQ29va2llcyA9IENvb2tpZXMuZ2V0KCk7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gYWxsQ29va2llcykge1xuICAgICAgQ29va2llcy5yZW1vdmUoa2V5KTtcbiAgICB9XG4gIH1cblxuICBnZXRJdGVtKGtleTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgY29uc3QgdmFsdWUgPSBDb29raWVzLmdldChrZXkpO1xuICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiBudWxsO1xuICB9XG5cbiAga2V5KGluZGV4OiBudW1iZXIpOiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoQ29va2llcy5nZXQoKSk7XG4gICAgcmV0dXJuIGtleXMubGVuZ3RoID4gaW5kZXggPyBrZXlzW2luZGV4XSA6IG51bGw7XG4gIH1cblxuICByZW1vdmVJdGVtKGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgQ29va2llcy5yZW1vdmUoa2V5KTtcbiAgfVxuXG4gIHNldEl0ZW0oa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBDb29raWVzLnNldChrZXksIHZhbHVlKTtcbiAgfVxuXG4gIC8vIE9wdGlvbmFsOiBJbXBsZW1lbnQgdG9TdHJpbmcoKSBtZXRob2QgZm9yIGRlYnVnZ2luZyBvciBsb2dnaW5nXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KENvb2tpZXMuZ2V0KCksIG51bGwsIDIpO1xuICB9XG59XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VEb2N1bWVudFRpdGxlKHRpdGxlOiBzdHJpbmcpIHtcbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBkb2N1bWVudC50aXRsZSA9IHRpdGxlO1xuICB9LCBbdGl0bGVdKTtcbn1cbiIsImltcG9ydCB7IHVzZUVmZmVjdCB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlQXBwbGVUb3VjaEZhdmljb24gfSBmcm9tIFwiQC9ob29rcy91c2UtYXBwbGUtdG91Y2gtZmF2aWNvblwiO1xuaW1wb3J0IHsgdXNlSWNvRmF2aWNvbiB9IGZyb20gXCJAL2hvb2tzL3VzZS1pY28tZmF2aWNvblwiO1xuaW1wb3J0IHsgdXNlU3ZnRmF2aWNvbiB9IGZyb20gXCJAL2hvb2tzL3VzZS1zdmctZmF2aWNvblwiO1xuXG4vLyBodHRwczovL2V2aWxtYXJ0aWFucy5jb20vY2hyb25pY2xlcy9ob3ctdG8tZmF2aWNvbi1pbi0yMDIxLXNpeC1maWxlcy10aGF0LWZpdC1tb3N0LW5lZWRzXG5leHBvcnQgZnVuY3Rpb24gdXNlRmF2aWNvbihcbiAgc3ZnOiBzdHJpbmcgfCBTVkdFbGVtZW50LFxuICBpY286IHN0cmluZywgLy8gMzJ4MzJcbiAgYXBwbGVUb3VjaDogc3RyaW5nLCAvLyAxODDDlzE4MFxuKTogdm9pZCB7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgdXNlU3ZnRmF2aWNvbihzdmcpO1xuICAgIHVzZUljb0Zhdmljb24oaWNvKTtcbiAgICB1c2VBcHBsZVRvdWNoRmF2aWNvbihhcHBsZVRvdWNoKTtcbiAgfSwgW3N2ZywgaWNvLCBhcHBsZVRvdWNoXSk7XG59XG4iLCJpbXBvcnQgeyB1c2VFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUFwcGxlVG91Y2hGYXZpY29uKFxuICBhcHBsZVRvdWNoOiBzdHJpbmcsIC8vIDE4MMOXMTgwXG4pOiB2b2lkIHtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBRdWVyeSBmb3IgdGhlIGFwcGxlIHRvdWNoIGxpbmtcbiAgICBjb25zdCBhcHBsZVRvdWNoUXVlcnkgPSAnbGlua1tyZWw9XCJhcHBsZS10b3VjaC1pY29uXCJdJztcbiAgICBsZXQgYXBwbGVUb3VjaExpbmsgPVxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MTGlua0VsZW1lbnQ+KGFwcGxlVG91Y2hRdWVyeSk7XG4gICAgaWYgKCFhcHBsZVRvdWNoTGluaykge1xuICAgICAgYXBwbGVUb3VjaExpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlua1wiKTtcbiAgICAgIGFwcGxlVG91Y2hMaW5rLnJlbCA9IFwiYXBwbGUtdG91Y2gtaWNvblwiO1xuICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChhcHBsZVRvdWNoTGluayk7XG4gICAgfVxuICAgIGFwcGxlVG91Y2hMaW5rLmhyZWYgPSBhcHBsZVRvdWNoO1xuICB9LCBbYXBwbGVUb3VjaF0pO1xufVxuIiwiaW1wb3J0IHsgdXNlRWZmZWN0IH0gZnJvbSBcInJlYWN0XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VJY29GYXZpY29uKFxuICBpY286IHN0cmluZywgLy8gMzJ4MzJcbik6IHZvaWQge1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFF1ZXJ5IGZvciB0aGUgaWNvIGxpbmtcbiAgICBjb25zdCBpY29RdWVyeSA9ICdsaW5rW3JlbD1cImljb25cIl06bm90KFt0eXBlPVwiaW1hZ2Uvc3ZnK3htbFwiXSknO1xuICAgIGxldCBpY29MaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MTGlua0VsZW1lbnQ+KGljb1F1ZXJ5KTtcbiAgICBpZiAoIWljb0xpbmspIHtcbiAgICAgIGljb0xpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlua1wiKTtcbiAgICAgIGljb0xpbmsucmVsID0gXCJpY29uXCI7XG4gICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGljb0xpbmspO1xuICAgIH1cblxuICAgIGljb0xpbmsuaHJlZiA9IGljbztcbiAgfSwgW2ljb10pO1xufVxuIiwiaW1wb3J0IHsgdXNlRWZmZWN0IH0gZnJvbSBcInJlYWN0XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VTdmdGYXZpY29uKHN2Zzogc3RyaW5nIHwgU1ZHRWxlbWVudCk6IHZvaWQge1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFF1ZXJ5IGZvciB0aGUgU1ZHIGljb24gbGlua1xuICAgIGNvbnN0IHN2Z1F1ZXJ5ID0gJ2xpbmtbcmVsPVwiaWNvblwiXVt0eXBlPVwiaW1hZ2Uvc3ZnK3htbFwiXSc7XG4gICAgbGV0IHN2Z0xpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxMaW5rRWxlbWVudD4oc3ZnUXVlcnkpO1xuXG4gICAgaWYgKCFzdmdMaW5rKSB7XG4gICAgICBzdmdMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIik7XG4gICAgICBzdmdMaW5rLnR5cGUgPSBcImltYWdlL3N2Zyt4bWxcIjtcbiAgICAgIHN2Z0xpbmsucmVsID0gXCJpY29uXCI7XG4gICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN2Z0xpbmspO1xuICAgIH1cblxuICAgIGlmIChzdmcgaW5zdGFuY2VvZiBTVkdFbGVtZW50KSB7XG4gICAgICBzdmdMaW5rLmhyZWYgPSBcImRhdGE6aW1hZ2Uvc3ZnK3htbDt1dGY4LFwiICsgc3ZnO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdmdMaW5rLmhyZWYgPSBzdmc7XG4gICAgfVxuICB9LCBbc3ZnXSk7XG59XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBBc3luY1Jlc3VsdCwgQXdhaXRpbmcsIEZhaWx1cmUsIFN1Y2Nlc3MgfSBmcm9tIFwiQHRhY3RpY3MvanMtbW9uYWRcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUNvcHlUb0NsaXBib2FyZCgpOiBBc3luY1Jlc3VsdDxzdHJpbmc+IHtcbiAgY29uc3QgW2NvcGllZFRleHQsIHNldENvcGllZFRleHRdID0gUmVhY3QudXNlU3RhdGU8QXN5bmNSZXN1bHQ8c3RyaW5nPj4oXG4gICAgbmV3IEF3YWl0aW5nKCksXG4gICk7XG5cbiAgY29uc3QgY29weVRvQ2xpcGJvYXJkID0gUmVhY3QudXNlQ2FsbGJhY2soKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICByZXR1cm4gKFxuICAgICAgbmF2aWdhdG9yLmNsaXBib2FyZCAmJlxuICAgICAgbmF2aWdhdG9yLmNsaXBib2FyZFxuICAgICAgICAud3JpdGVUZXh0KHZhbHVlKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgc2V0Q29waWVkVGV4dChTdWNjZXNzLm9mKHZhbHVlKSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyb3I6IERPTUV4Y2VwdGlvbikgPT4ge1xuICAgICAgICAgIHNldENvcGllZFRleHQoRmFpbHVyZS5kdWVUbyhlcnJvci5tZXNzYWdlLCBlcnJvci5uYW1lKSk7XG4gICAgICAgIH0pXG4gICAgKTtcbiAgfSwgW10pO1xuXG4gIHJldHVybiBbY29waWVkVGV4dCwgY29weVRvQ2xpcGJvYXJkXTtcbn1cbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IEFzeW5jUmVzdWx0LCBBd2FpdGluZywgRmFpbHVyZSwgU3VjY2VzcyB9IGZyb20gXCJAdGFjdGljcy9qcy1tb25hZFwiO1xuXG5pbnRlcmZhY2UgR2VvbG9jYXRpb25TdGF0ZSB7XG4gIGFjY3VyYWN5OiBudW1iZXIgfCBudWxsO1xuICBhbHRpdHVkZTogbnVtYmVyIHwgbnVsbDtcbiAgYWx0aXR1ZGVBY2N1cmFjeTogbnVtYmVyIHwgbnVsbDtcbiAgaGVhZGluZzogbnVtYmVyIHwgbnVsbDtcbiAgbGF0aXR1ZGU6IG51bWJlciB8IG51bGw7XG4gIGxvbmdpdHVkZTogbnVtYmVyIHwgbnVsbDtcbiAgc3BlZWQ6IG51bWJlciB8IG51bGw7XG4gIHRpbWVzdGFtcDogbnVtYmVyIHwgbnVsbDtcbn1cblxuaW50ZXJmYWNlIEdlb2xvY2F0aW9uT3B0aW9ucyB7XG4gIGVuYWJsZUhpZ2hBY2N1cmFjeT86IGJvb2xlYW47XG4gIHRpbWVvdXQ/OiBudW1iZXI7XG4gIG1heGltdW1BZ2U/OiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBQb3NpdGlvbiB7XG4gIGNvb3Jkczoge1xuICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgbG9uZ2l0dWRlOiBudW1iZXI7XG4gICAgYWNjdXJhY3k6IG51bWJlcjtcbiAgICBhbHRpdHVkZTogbnVtYmVyIHwgbnVsbDtcbiAgICBhbHRpdHVkZUFjY3VyYWN5OiBudW1iZXIgfCBudWxsO1xuICAgIGhlYWRpbmc6IG51bWJlciB8IG51bGw7XG4gICAgc3BlZWQ6IG51bWJlciB8IG51bGw7XG4gIH07XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgUG9zaXRpb25FcnJvciB7XG4gIGNvZGU6IG51bWJlcjtcbiAgbWVzc2FnZTogc3RyaW5nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXNlR2VvbG9jYXRpb24oXG4gIG9wdGlvbnM6IEdlb2xvY2F0aW9uT3B0aW9ucyA9IHt9LFxuKTogQXN5bmNSZXN1bHQ8R2VvbG9jYXRpb25TdGF0ZT4ge1xuICBjb25zdCBbc3RhdGUsIHNldFN0YXRlXSA9IFJlYWN0LnVzZVN0YXRlPEFzeW5jUmVzdWx0PEdlb2xvY2F0aW9uU3RhdGU+PihcbiAgICBuZXcgQXdhaXRpbmcoKSxcbiAgKTtcbiAgY29uc3Qgb3B0aW9uc1JlZiA9IFJlYWN0LnVzZVJlZjxHZW9sb2NhdGlvbk9wdGlvbnM+KG9wdGlvbnMpO1xuXG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3Qgb25FdmVudCA9ICh7IGNvb3JkcywgdGltZXN0YW1wIH06IFBvc2l0aW9uKSA9PiB7XG4gICAgICBzZXRTdGF0ZShcbiAgICAgICAgU3VjY2Vzcy5vZih7XG4gICAgICAgICAgdGltZXN0YW1wLFxuICAgICAgICAgIGxhdGl0dWRlOiBjb29yZHMubGF0aXR1ZGUsXG4gICAgICAgICAgbG9uZ2l0dWRlOiBjb29yZHMubG9uZ2l0dWRlLFxuICAgICAgICAgIGFsdGl0dWRlOiBjb29yZHMuYWx0aXR1ZGUsXG4gICAgICAgICAgYWNjdXJhY3k6IGNvb3Jkcy5hY2N1cmFjeSxcbiAgICAgICAgICBhbHRpdHVkZUFjY3VyYWN5OiBjb29yZHMuYWx0aXR1ZGVBY2N1cmFjeSxcbiAgICAgICAgICBoZWFkaW5nOiBjb29yZHMuaGVhZGluZyxcbiAgICAgICAgICBzcGVlZDogY29vcmRzLnNwZWVkLFxuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgfTtcblxuICAgIGNvbnN0IG9uRXZlbnRFcnJvciA9IChlcnJvcjogUG9zaXRpb25FcnJvcikgPT4ge1xuICAgICAgc2V0U3RhdGUoRmFpbHVyZS5kdWVUbyhlcnJvci5tZXNzYWdlLCBTdHJpbmcoZXJyb3IuY29kZSkpKTtcbiAgICB9O1xuXG4gICAgY29uc3QgeyBlbmFibGVIaWdoQWNjdXJhY3ksIHRpbWVvdXQsIG1heGltdW1BZ2UgfSA9IG9wdGlvbnNSZWYuY3VycmVudDtcblxuICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24ob25FdmVudCwgb25FdmVudEVycm9yLCB7XG4gICAgICBlbmFibGVIaWdoQWNjdXJhY3ksXG4gICAgICB0aW1lb3V0LFxuICAgICAgbWF4aW11bUFnZSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHdhdGNoSWQgPSBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24ud2F0Y2hQb3NpdGlvbihvbkV2ZW50LCBvbkV2ZW50RXJyb3IsIHtcbiAgICAgIGVuYWJsZUhpZ2hBY2N1cmFjeSxcbiAgICAgIHRpbWVvdXQsXG4gICAgICBtYXhpbXVtQWdlLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5jbGVhcldhdGNoKHdhdGNoSWQpO1xuICAgIH07XG4gIH0sIFtdKTtcblxuICByZXR1cm4gc3RhdGU7XG59XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VFdmVudExpc3RlbmVyIH0gZnJvbSBcIkAvaG9va3MvdXNlLWV2ZW50LWxpc3RlbmVyXCI7XG5pbXBvcnQgeyB1c2VUaHJvdHRsZSB9IGZyb20gXCJAL2hvb2tzL3VzZS10cm90dGxlXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VJZGxlKG1zOiBudW1iZXIgPSAxMDAwICogNjApOiBib29sZWFuIHtcbiAgY29uc3QgW2lkbGUsIHNldElkbGVdID0gUmVhY3QudXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuXG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbGV0IHRpbWVvdXRJZDogbnVtYmVyO1xuXG4gICAgY29uc3QgaGFuZGxlVGltZW91dCA9ICgpID0+IHtcbiAgICAgIHNldElkbGUodHJ1ZSk7XG4gICAgfTtcblxuICAgIGNvbnN0IGhhbmRsZUV2ZW50ID0gdXNlVGhyb3R0bGUoKGU6IEV2ZW50KSA9PiB7XG4gICAgICBzZXRJZGxlKGZhbHNlKTtcblxuICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgdGltZW91dElkID0gd2luZG93LnNldFRpbWVvdXQoaGFuZGxlVGltZW91dCwgbXMpO1xuICAgIH0sIDUwMCk7XG5cbiAgICBjb25zdCBoYW5kbGVWaXNpYmlsaXR5Q2hhbmdlID0gKGU6IEV2ZW50KSA9PiB7XG4gICAgICBpZiAoIWRvY3VtZW50LmhpZGRlbikge1xuICAgICAgICBoYW5kbGVFdmVudChlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGltZW91dElkID0gd2luZG93LnNldFRpbWVvdXQoaGFuZGxlVGltZW91dCwgbXMpO1xuXG4gICAgdXNlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBoYW5kbGVFdmVudCk7XG4gICAgdXNlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVFdmVudCk7XG4gICAgdXNlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCBoYW5kbGVFdmVudCk7XG4gICAgdXNlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXZlbnQpO1xuICAgIHVzZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIGhhbmRsZUV2ZW50KTtcbiAgICB1c2VFdmVudExpc3RlbmVyKFwid2hlZWxcIiwgaGFuZGxlRXZlbnQpO1xuICAgIHVzZUV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsIGhhbmRsZVZpc2liaWxpdHlDaGFuZ2UpO1xuICB9LCBbbXNdKTtcblxuICByZXR1cm4gaWRsZTtcbn1cbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZU1lZGlhUXVlcnkocXVlcnk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBjb25zdCBzdWJzY3JpYmUgPSBSZWFjdC51c2VDYWxsYmFjayhcbiAgICAoY2FsbGJhY2s6ICh0aGlzOiBNZWRpYVF1ZXJ5TGlzdCwgZXY6IE1lZGlhUXVlcnlMaXN0RXZlbnQpID0+IGFueSkgPT4ge1xuICAgICAgY29uc3QgbWF0Y2hNZWRpYSA9IHdpbmRvdy5tYXRjaE1lZGlhKHF1ZXJ5KTtcblxuICAgICAgbWF0Y2hNZWRpYS5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGNhbGxiYWNrKTtcbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIG1hdGNoTWVkaWEucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBjYWxsYmFjayk7XG4gICAgICB9O1xuICAgIH0sXG4gICAgW3F1ZXJ5XSxcbiAgKTtcblxuICBjb25zdCBnZXRTbmFwc2hvdCA9ICgpOiBib29sZWFuID0+IHtcbiAgICByZXR1cm4gd2luZG93Lm1hdGNoTWVkaWEocXVlcnkpLm1hdGNoZXM7XG4gIH07XG5cbiAgY29uc3QgZ2V0U2VydmVyU25hcHNob3QgPSAoKTogYm9vbGVhbiA9PiB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwidXNlTWVkaWFRdWVyeSBpcyBhIGNsaWVudC1vbmx5IGhvb2tcIik7XG4gIH07XG5cbiAgcmV0dXJuIFJlYWN0LnVzZVN5bmNFeHRlcm5hbFN0b3JlKHN1YnNjcmliZSwgZ2V0U25hcHNob3QsIGdldFNlcnZlclNuYXBzaG90KTtcbn1cbiIsImltcG9ydCB7IHVzZU1lZGlhUXVlcnkgfSBmcm9tIFwiQC9ob29rcy91c2UtbWVkaWEtcXVlcnlcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVByZWZlcnNEYXJrTW9kZSgpOiBib29sZWFuIHtcbiAgcmV0dXJuIHVzZU1lZGlhUXVlcnkoXCIocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspXCIpO1xufVxuIiwiaW1wb3J0IHsgdXNlQnJvd3NlckFjY2Vzc2liaWxpdHlQcmVmZXJlbmNlcyB9IGZyb20gXCJAL2hvb2tzL3VzZS1hY2Nlc3NpYmlsaXR5LXByZWZlcmVuY2VzXCI7XG5pbXBvcnQgeyB1c2VNZWRpYVF1ZXJ5IH0gZnJvbSBcIkAvaG9va3MvdXNlLW1lZGlhLXF1ZXJ5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VQcmVmZXJzSGlnaENvbnRhc3QoKTogYm9vbGVhbiB7XG4gIHJldHVybiB1c2VNZWRpYVF1ZXJ5KFwiKHByZWZlcnMtY29udHJhc3Q6IG1vcmUpXCIpO1xufVxuIiwiaW1wb3J0IHsgdXNlTWVkaWFRdWVyeSB9IGZyb20gXCJAL2hvb2tzL3VzZS1tZWRpYS1xdWVyeVwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlUHJlZmVyc0xvd0NvbnRyYXN0KCk6IGJvb2xlYW4ge1xuICByZXR1cm4gdXNlTWVkaWFRdWVyeShcIihwcmVmZXJzLWNvbnRyYXN0OiBsZXNzKVwiKTtcbn1cbiIsImltcG9ydCB7IHVzZU1lZGlhUXVlcnkgfSBmcm9tIFwiQC9ob29rcy91c2UtbWVkaWEtcXVlcnlcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVByZWZlcnNSZWR1Y2VkTW90aW9uKCk6IGJvb2xlYW4ge1xuICByZXR1cm4gdXNlTWVkaWFRdWVyeShcIihwcmVmZXJzLXJlZHVjZWQtbW90aW9uOiByZWR1Y2UpXCIpO1xufVxuIiwiaW1wb3J0IHsgdXNlQnJvd3NlckFjY2Vzc2liaWxpdHlQcmVmZXJlbmNlcyB9IGZyb20gXCJAL2hvb2tzL3VzZS1hY2Nlc3NpYmlsaXR5LXByZWZlcmVuY2VzXCI7XG5pbXBvcnQgeyB1c2VNZWRpYVF1ZXJ5IH0gZnJvbSBcIkAvaG9va3MvdXNlLW1lZGlhLXF1ZXJ5XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VQcmVmZXJzUmVkdWNlZFRyYW5zcGFyYW5jeSgpOiBib29sZWFuIHtcbiAgcmV0dXJuIHVzZU1lZGlhUXVlcnkoXCIocHJlZmVycy1yZWR1Y2VkLXRyYW5zcGFyZW5jeTogcmVkdWNlKVwiKTtcbn1cbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IEFzeW5jUmVzdWx0LCBBd2FpdGluZywgU3VjY2VzcywgRmFpbHVyZSB9IGZyb20gXCJAdGFjdGljcy9qcy1tb25hZFwiO1xuXG5pbnRlcmZhY2UgU2NyaXB0T3B0aW9ucyB7XG4gIHJlbW92ZU9uVW5tb3VudD86IGJvb2xlYW47XG59XG5cbnR5cGUgU3VjY2Vzc1Jlc3BvbnNlID0gXCJyZWFkeVwiIHwgXCJleHRlcm5hbFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlU2NyaXB0KFxuICBzcmM6IHN0cmluZyxcbiAgb3B0aW9uczogU2NyaXB0T3B0aW9ucyA9IHt9LFxuKTogQXN5bmNSZXN1bHQ8U3VjY2Vzc1Jlc3BvbnNlPiB7XG4gIGNvbnN0IFtzdGF0dXMsIHNldFN0YXR1c10gPSBSZWFjdC51c2VTdGF0ZTxBc3luY1Jlc3VsdDxib29sZWFuPj4oXG4gICAgbmV3IEF3YWl0aW5nKCksXG4gICk7XG4gIGNvbnN0IG9wdGlvbnNSZWYgPSBSZWFjdC51c2VSZWY8U2NyaXB0T3B0aW9ucz4ob3B0aW9ucyk7XG5cbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBsZXQgc2NyaXB0OiBIVE1MU2NyaXB0RWxlbWVudCB8IG51bGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYHNjcmlwdFtzcmM9XCIke3NyY31cIl1gLFxuICAgICk7XG5cbiAgICBpZiAoc2NyaXB0KSB7XG4gICAgICAvLyBXaGVuIHN0YXR1cyBpcyBudWxsLCBhIHNjcmlwdCBpcyBleHRlcm5hbGx5IGFkZGVkIG91dHNpZGUgb2YgdGhpcyBmdW5jdGlvbiwgd2UgYXNzdW1lIHN1Y2Nlc3MgYW5kIG1hcmsgaXQgYXMgZXh0ZXJuYWxcbiAgICAgIGNvbnN0IGRvbVN0YXR1cyA9IHNjcmlwdC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXN0YXR1c1wiKTtcbiAgICAgIHN3aXRjaCAoZG9tU3RhdHVzKSB7XG4gICAgICAgIGNhc2UgXCJyZWFkeVwiOlxuICAgICAgICAgIHNldFN0YXR1cyhTdWNjZXNzLm9mKFwicmVhZHlcIikpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiZXJyb3JcIjpcbiAgICAgICAgICBzZXRTdGF0dXMoRmFpbHVyZS5kdWVUbyhgRmFpbGVkIHRvIGxvYWQgc2NyaXB0OiAke3NyY31gLCBcImVycm9yXCIpKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBzZXRTdGF0dXMoU3VjY2Vzcy5vZihcImV4dGVybmFsXCIpKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcbiAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgc2NyaXB0LnNyYyA9IHNyYztcbiAgICAgICAgc2NyaXB0LmFzeW5jID0gdHJ1ZTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpO1xuXG4gICAgICAgIGNvbnN0IGhhbmRsZVNjcmlwdExvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgc2NyaXB0Py5zZXRBdHRyaWJ1dGUoXCJkYXRhLXN0YXR1c1wiLCBcInJlYWR5XCIpO1xuICAgICAgICAgIHNldFN0YXR1cyhTdWNjZXNzLm9mKHRydWUpKTtcbiAgICAgICAgICBjbGVhbnVwTGlzdGVuZXJzKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgaGFuZGxlU2NyaXB0RXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgc2NyaXB0Py5zZXRBdHRyaWJ1dGUoXCJkYXRhLXN0YXR1c1wiLCBcImVycm9yXCIpO1xuICAgICAgICAgIHNldFN0YXR1cyhGYWlsdXJlLmR1ZVRvKGBGYWlsZWQgdG8gbG9hZCBzY3JpcHQ6ICR7c3JjfWAsIFwiZXJyb3JcIikpO1xuICAgICAgICAgIGNsZWFudXBMaXN0ZW5lcnMoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBjbGVhbnVwTGlzdGVuZXJzID0gKCkgPT4ge1xuICAgICAgICAgIHNjcmlwdD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgaGFuZGxlU2NyaXB0TG9hZCk7XG4gICAgICAgICAgc2NyaXB0Py5yZW1vdmVFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgaGFuZGxlU2NyaXB0RXJyb3IpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHNjcmlwdC5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBoYW5kbGVTY3JpcHRMb2FkKTtcbiAgICAgICAgc2NyaXB0LmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBoYW5kbGVTY3JpcHRFcnJvcik7XG5cbiAgICAgICAgY29uc3QgcmVtb3ZlT25Vbm1vdW50ID0gb3B0aW9uc1JlZi5jdXJyZW50LnJlbW92ZU9uVW5tb3VudDtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICBpZiAocmVtb3ZlT25Vbm1vdW50ID09PSB0cnVlKSB7XG4gICAgICAgICAgICBzY3JpcHQ/LnJlbW92ZSgpO1xuICAgICAgICAgICAgY2xlYW51cExpc3RlbmVycygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldFN0YXR1cyhcbiAgICAgICAgICBGYWlsdXJlLmR1ZVRvKGBGYWlsZWQgdG8gYWRkIHNjcmlwdCB0YWcgZm9yIDogJHtzcmN9YCwgXCJlcnJvclwiKSxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFtzcmNdKTtcblxuICByZXR1cm4gc3RhdHVzO1xufVxuIiwiaW1wb3J0IFJlYWN0LCB7XG4gIHVzZUNhbGxiYWNrLFxuICB1c2VFZmZlY3QsXG4gIHVzZVJlZixcbiAgdXNlU3luY0V4dGVybmFsU3RvcmUsXG59IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgUmVzdWx0IH0gZnJvbSBcIkB0YWN0aWNzL2pzLW1vbmFkXCI7XG5pbXBvcnQge1xuICBnZXRTdG9yYWdlSXRlbSxcbiAgZ2V0U3RvcmFnZVNlcnZlclNuYXBzaG90LFxuICByZW1vdmVTdG9yYWdlSXRlbSxcbiAgc2V0U3RvcmFnZUl0ZW0sXG59IGZyb20gXCJAL3N0b3JhZ2Uvc3RvcmFnZVwiO1xuaW1wb3J0IHsgdXNlRXZlbnRMaXN0ZW5lciB9IGZyb20gXCJAL2hvb2tzL3VzZS1ldmVudC1saXN0ZW5lclwiO1xuXG5mdW5jdGlvbiBkZWVwRXF1YWwob2JqMTogYW55LCBvYmoyOiBhbnkpOiBib29sZWFuIHtcbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iajEpID09PSBKU09OLnN0cmluZ2lmeShvYmoyKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVN0b3JhZ2U8VD4oXG4gIGtleTogc3RyaW5nLFxuICBpbml0aWFsVmFsdWU6IFQsXG4gIHN0b3JhZ2VBcmVhOiBTdG9yYWdlLFxuKTogW1Jlc3VsdDxUPiwgKHZhbHVlOiBSZWFjdC5TZXRTdGF0ZUFjdGlvbjxUPikgPT4gdm9pZCwgKCkgPT4gdm9pZF0ge1xuICAvLyBNZW1vaXplIHRoZSBnZXRTbmFwc2hvdCBmdW5jdGlvblxuICBjb25zdCBnZXRTbmFwc2hvdCA9IHVzZUNhbGxiYWNrKFxuICAgICgpID0+IGdldFN0b3JhZ2VJdGVtPFQ+KGtleSwgc3RvcmFnZUFyZWEpLFxuICAgIFtrZXksIHN0b3JhZ2VBcmVhXSxcbiAgKTtcblxuICAvLyBVc2UgYSByZWYgdG8gY2FjaGUgdGhlIHByZXZpb3VzIHJlc3VsdCBvZiBnZXRTbmFwc2hvdFxuICBjb25zdCBwcmV2aW91c1NuYXBzaG90UmVmID0gdXNlUmVmPFJlc3VsdDxUPj4oZ2V0U25hcHNob3QoKSk7XG5cbiAgY29uc3Qgc3Vic2NyaWJlID0gdXNlQ2FsbGJhY2soKGNhbGxiYWNrOiAoZXZlbnQ6IFN0b3JhZ2VFdmVudCkgPT4gdm9pZCkgPT4ge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic3RvcmFnZVwiLCBjYWxsYmFjayk7XG4gICAgcmV0dXJuICgpID0+IHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwic3RvcmFnZVwiLCBjYWxsYmFjayk7XG4gIH0sIFtdKTtcblxuICAvLyBDcmVhdGUgYSB3cmFwcGVyIGZ1bmN0aW9uIHRvIG1hbmFnZSB0aGUgY2FjaGVkIHNuYXBzaG90XG4gIGNvbnN0IGdldFNuYXBzaG90V2l0aENhY2hlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNvbnN0IG5ld1NuYXBzaG90ID0gZ2V0U25hcHNob3QoKTtcbiAgICBpZiAoXG4gICAgICBwcmV2aW91c1NuYXBzaG90UmVmLmN1cnJlbnQgPT09IG51bGwgfHxcbiAgICAgICFkZWVwRXF1YWwocHJldmlvdXNTbmFwc2hvdFJlZi5jdXJyZW50LCBuZXdTbmFwc2hvdCkgLy8gTmVlZGVkIHNpbmNlIHdlIGNyZWF0ZSBuZXcgb2JqZWN0cyB3aXRoIHRoZSBzYW1lIHZhbHVlXG4gICAgKSB7XG4gICAgICBwcmV2aW91c1NuYXBzaG90UmVmLmN1cnJlbnQgPSBuZXdTbmFwc2hvdDtcbiAgICB9XG4gICAgcmV0dXJuIHByZXZpb3VzU25hcHNob3RSZWYuY3VycmVudDtcbiAgfSwgW2dldFNuYXBzaG90XSk7XG5cbiAgY29uc3Qgc3RvcmVkID0gdXNlU3luY0V4dGVybmFsU3RvcmUoXG4gICAgc3Vic2NyaWJlLFxuICAgIGdldFNuYXBzaG90V2l0aENhY2hlLFxuICAgIGdldFN0b3JhZ2VTZXJ2ZXJTbmFwc2hvdCxcbiAgKTtcblxuICBjb25zdCBzZXQgPSB1c2VDYWxsYmFjayhcbiAgICAodmFsdWU6IFJlYWN0LlNldFN0YXRlQWN0aW9uPFQ+KSA9PiB7XG4gICAgICBjb25zdCBuZXh0U3RhdGUgPSB2YWx1ZTtcbiAgICAgIGlmIChuZXh0U3RhdGUgPT09IG51bGwpIHtcbiAgICAgICAgcmVtb3ZlU3RvcmFnZUl0ZW0oa2V5LCBzdG9yYWdlQXJlYSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXRTdG9yYWdlSXRlbShrZXksIG5leHRTdGF0ZSwgc3RvcmFnZUFyZWEpO1xuICAgICAgfVxuICAgIH0sXG4gICAgW2tleSwgc3RvcmFnZUFyZWFdLFxuICApO1xuXG4gIGNvbnN0IGNsZWFyID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHJlbW92ZVN0b3JhZ2VJdGVtKGtleSwgc3RvcmFnZUFyZWEpO1xuICB9LCBba2V5LCBzdG9yYWdlQXJlYV0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgc2V0U3RvcmFnZUl0ZW0oa2V5LCBpbml0aWFsVmFsdWUsIHN0b3JhZ2VBcmVhKTtcbiAgfSwgW2tleSwgaW5pdGlhbFZhbHVlLCBzdG9yYWdlQXJlYV0pO1xuXG4gIHJldHVybiBbc3RvcmVkLCBzZXQsIGNsZWFyXTtcbn1cbiIsImltcG9ydCB7IEZhaWx1cmUsIFJlc3VsdCwgU3VjY2VzcyB9IGZyb20gXCJAdGFjdGljcy9qcy1tb25hZFwiO1xuXG5leHBvcnQgY29uc3QgZW51bSBTdG9yYWdlRmFpbHVyZXMge1xuICBOT1RfQVZBSUxBQkxFID0gXCJOT1RfQVZBSUxBQkxFXCIsXG4gIElOVkFMSURfRk9STUFUID0gXCJJTlZBTElEX0ZPUk1BVFwiLFxufVxuXG5leHBvcnQgZnVuY3Rpb24gZGlzcGF0Y2hTdG9yYWdlRXZlbnQoXG4gIGtleTogc3RyaW5nLFxuICBuZXdWYWx1ZTogYW55LFxuICBvbGRWYWx1ZTogYW55LFxuICBzdG9yYWdlQXJlYTogU3RvcmFnZSxcbikge1xuICB3aW5kb3cuZGlzcGF0Y2hFdmVudChcbiAgICBuZXcgU3RvcmFnZUV2ZW50KFwic3RvcmFnZVwiLCB7IGtleSwgbmV3VmFsdWUsIG9sZFZhbHVlLCBzdG9yYWdlQXJlYSB9KSxcbiAgKTtcbn1cblxuZXhwb3J0IGNvbnN0IGdldFN0b3JhZ2VTZXJ2ZXJTbmFwc2hvdCA9ICgpID0+IHtcbiAgdGhyb3cgRXJyb3IoXCJ0aGlzIGlzIGEgY2xpZW50LW9ubHkgaG9va1wiKTtcbn07XG5cbi8vIEhlbHBlciBmdW5jdGlvbnMgdG8gaW50ZXJhY3Qgd2l0aCBzZXNzaW9uU3RvcmFnZVxuZXhwb3J0IGZ1bmN0aW9uIGdldFN0b3JhZ2VJdGVtPFQ+KFxuICBrZXk6IHN0cmluZyxcbiAgc3RvcmFnZUFyZWE6IFN0b3JhZ2UsXG4pOiBSZXN1bHQ8VD4ge1xuICBjb25zdCBpdGVtID0gc3RvcmFnZUFyZWEuZ2V0SXRlbShrZXkpO1xuICBpZiAoIWl0ZW0pIHtcbiAgICByZXR1cm4gRmFpbHVyZS5kdWVUbyhcbiAgICAgIGAke2tleX0gaXMgbm90IGF2YWlsYWJsZSBpbiAke3N0b3JhZ2VBcmVhfSBzdG9yYWdlYCxcbiAgICAgIFN0b3JhZ2VGYWlsdXJlcy5OT1RfQVZBSUxBQkxFLFxuICAgICk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IG9iamVjdCA9IEpTT04ucGFyc2UoaXRlbSk7XG4gICAgcmV0dXJuIFN1Y2Nlc3Mub2Yob2JqZWN0KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gRmFpbHVyZS5kdWVUbyhcbiAgICAgIGAke2tleX0gaGFzIGludmFsaWQgZm9ybWF0IGluIHN0b3JhZ2VgLFxuICAgICAgU3RvcmFnZUZhaWx1cmVzLklOVkFMSURfRk9STUFULFxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldFN0b3JhZ2VJdGVtPFQ+KFxuICBrZXk6IHN0cmluZyxcbiAgdmFsdWU6IFQsXG4gIHN0b3JhZ2VBcmVhOiBTdG9yYWdlLFxuKTogUmVzdWx0PFQ+IHtcbiAgY29uc3QgY3VycmVudEl0ZW0gPSBnZXRTdG9yYWdlSXRlbShrZXksIHN0b3JhZ2VBcmVhKTtcblxuICB0cnkge1xuICAgIGNvbnN0IGl0ZW0gPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XG4gICAgc3RvcmFnZUFyZWEuc2V0SXRlbShrZXksIGl0ZW0pO1xuICAgIGRpc3BhdGNoU3RvcmFnZUV2ZW50KFxuICAgICAga2V5LFxuICAgICAgdmFsdWUsXG4gICAgICBjdXJyZW50SXRlbSBpbnN0YW5jZW9mIEZhaWx1cmUgPyBudWxsIDogY3VycmVudEl0ZW0udW53cmFwKCksXG4gICAgICBzdG9yYWdlQXJlYSxcbiAgICApO1xuICAgIHJldHVybiBTdWNjZXNzLm9mKHZhbHVlKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gRmFpbHVyZS5kdWVUbyhcbiAgICAgIGAke3ZhbHVlfSBoYXMgaW52YWxpZCBmb3JtYXQgdG8gcHV0IGludG8gc3RvcmFnZWAsXG4gICAgICBTdG9yYWdlRmFpbHVyZXMuSU5WQUxJRF9GT1JNQVQsXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlU3RvcmFnZUl0ZW0oXG4gIGtleTogc3RyaW5nLFxuICBzdG9yYWdlQXJlYTogU3RvcmFnZSxcbik6IFJlc3VsdDxzdHJpbmc+IHtcbiAgY29uc3QgY3VycmVudEl0ZW0gPSBnZXRTdG9yYWdlSXRlbShrZXksIHN0b3JhZ2VBcmVhKTtcbiAgaWYgKGN1cnJlbnRJdGVtIGluc3RhbmNlb2YgRmFpbHVyZSkge1xuICAgIHN0b3JhZ2VBcmVhLnJlbW92ZUl0ZW0oa2V5KTtcbiAgICByZXR1cm4gU3VjY2Vzcy5vZihrZXkpO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBzdG9yYWdlQXJlYS5yZW1vdmVJdGVtKGtleSk7XG4gICAgZGlzcGF0Y2hTdG9yYWdlRXZlbnQoa2V5LCBudWxsLCBjdXJyZW50SXRlbS51bndyYXAoKSwgc3RvcmFnZUFyZWEpO1xuICAgIHJldHVybiBTdWNjZXNzLm9mKGtleSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIEZhaWx1cmUuZHVlVG8oXG4gICAgICBgJHtrZXl9IGNvdWxkIG5vdCBiZSByZW1vdmVkIGZyb20gc3RvcmFnZWAsXG4gICAgICBTdG9yYWdlRmFpbHVyZXMuSU5WQUxJRF9GT1JNQVQsXG4gICAgKTtcbiAgfVxufVxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNjcm9sbFN0YXRlIHtcbiAgeDogbnVtYmVyO1xuICB5OiBudW1iZXI7XG59XG5cbmV4cG9ydCB0eXBlIFNjcm9sbFRvQXJncyA9IFtvcHRpb25zOiBTY3JvbGxUb09wdGlvbnNdIHwgW3g6IG51bWJlciwgeTogbnVtYmVyXTtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVdpbmRvd1Njcm9sbCgpOiBbXG4gIFNjcm9sbFN0YXRlLFxuICAoLi4uYXJnczogU2Nyb2xsVG9BcmdzKSA9PiB2b2lkLFxuXSB7XG4gIGNvbnN0IFtzdGF0ZSwgc2V0U3RhdGVdID0gUmVhY3QudXNlU3RhdGU8U2Nyb2xsU3RhdGU+KHtcbiAgICB4OiAwLFxuICAgIHk6IDAsXG4gIH0pO1xuXG4gIGNvbnN0IHNjcm9sbFRvID0gUmVhY3QudXNlQ2FsbGJhY2soKC4uLmFyZ3M6IFNjcm9sbFRvQXJncykgPT4ge1xuICAgIGlmICh0eXBlb2YgYXJnc1swXSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgd2luZG93LnNjcm9sbFRvKGFyZ3NbMF0pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZ3NbMF0gPT09IFwibnVtYmVyXCIgJiYgdHlwZW9mIGFyZ3NbMV0gPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIHdpbmRvdy5zY3JvbGxUbyhhcmdzWzBdLCBhcmdzWzFdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgSW52YWxpZCBhcmd1bWVudHMgcGFzc2VkIHRvIHNjcm9sbFRvLiBTZWUgaGVyZSBmb3IgbW9yZSBpbmZvOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2luZG93L3Njcm9sbFRvYCxcbiAgICAgICk7XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgUmVhY3QudXNlTGF5b3V0RWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBoYW5kbGVTY3JvbGwgPSAoKSA9PiB7XG4gICAgICBzZXRTdGF0ZSh7IHg6IHdpbmRvdy5zY3JvbGxYLCB5OiB3aW5kb3cuc2Nyb2xsWSB9KTtcbiAgICB9O1xuXG4gICAgaGFuZGxlU2Nyb2xsKCk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgaGFuZGxlU2Nyb2xsKTtcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBoYW5kbGVTY3JvbGwpO1xuICAgIH07XG4gIH0sIFtdKTtcblxuICByZXR1cm4gW3N0YXRlLCBzY3JvbGxUb107XG59XG4iLCJpbXBvcnQgeyB1c2VFZmZlY3QsIHVzZVN0YXRlLCBSZWZPYmplY3QgfSBmcm9tIFwicmVhY3RcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZU9uU2NyZWVuKFxuICByZWY6IFJlZk9iamVjdDxFbGVtZW50PixcbiAgcm9vdE1hcmdpbjogc3RyaW5nID0gXCIwcHhcIixcbik6IGJvb2xlYW4ge1xuICBjb25zdCBbaXNWaXNpYmxlLCBzZXRJc1Zpc2libGVdID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHJlZi5jdXJyZW50ID09IG51bGwpIHJldHVybjtcblxuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKFxuICAgICAgKFtlbnRyeV0pID0+IHNldElzVmlzaWJsZShlbnRyeS5pc0ludGVyc2VjdGluZyksXG4gICAgICB7IHJvb3RNYXJnaW4gfSxcbiAgICApO1xuXG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZShyZWYuY3VycmVudCk7XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaWYgKHJlZi5jdXJyZW50ID09IG51bGwpIHJldHVybjtcbiAgICAgIG9ic2VydmVyLnVub2JzZXJ2ZShyZWYuY3VycmVudCk7XG4gICAgfTtcbiAgfSwgW3JlZi5jdXJyZW50LCByb290TWFyZ2luXSk7XG5cbiAgcmV0dXJuIGlzVmlzaWJsZTtcbn1cbiIsImV4cG9ydCBjbGFzcyBCcm93c2VyQWNjZXNzaWJpbGl0eVByZWZlcmVuY2VzIHtcbiAgcmVhZG9ubHkgcmVkdWNlZE1vdGlvbjogYm9vbGVhbjtcbiAgcmVhZG9ubHkgaGlnaENvbnRyYXN0OiBib29sZWFuO1xuICByZWFkb25seSBsb3dDb250cmFzdDogYm9vbGVhbjtcbiAgcmVhZG9ubHkgcmVkdWNlZFRyYW5zcGFyZW5jeTogYm9vbGVhbjtcbiAgcmVhZG9ubHkgZGFya01vZGU6IGJvb2xlYW47XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcmVkdWNlZE1vdGlvbjogYm9vbGVhbixcbiAgICBoaWdoQ29udHJhc3Q6IGJvb2xlYW4sXG4gICAgbG93Q29udHJhc3Q6IGJvb2xlYW4sXG4gICAgcmVkdWNlZFRyYW5zcGFyZW5jeTogYm9vbGVhbixcbiAgICBkYXJrTW9kZTogYm9vbGVhbixcbiAgKSB7XG4gICAgdGhpcy5yZWR1Y2VkTW90aW9uID0gcmVkdWNlZE1vdGlvbjtcbiAgICB0aGlzLmhpZ2hDb250cmFzdCA9IGhpZ2hDb250cmFzdDtcbiAgICB0aGlzLmxvd0NvbnRyYXN0ID0gbG93Q29udHJhc3Q7XG4gICAgdGhpcy5yZWR1Y2VkVHJhbnNwYXJlbmN5ID0gcmVkdWNlZFRyYW5zcGFyZW5jeTtcbiAgICB0aGlzLmRhcmtNb2RlID0gZGFya01vZGU7XG4gIH1cblxuICBwcmVmZXJzRGFya01vZGUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZGFya01vZGU7XG4gIH1cblxuICBwcmVmZXJzSGlnaENvbnRyYXN0KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmhpZ2hDb250cmFzdDtcbiAgfVxuXG4gIHByZWZlcnNMb3dDb250cmFzdCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5sb3dDb250cmFzdDtcbiAgfVxuXG4gIHByZWZlcnNSZWR1Y2VkTW90aW9uKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnJlZHVjZWRNb3Rpb247XG4gIH1cblxuICBwcmVmZXJzVHJhbnNwYXJlbmN5KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnJlZHVjZWRUcmFuc3BhcmVuY3k7XG4gIH1cbn1cbiIsImltcG9ydCB7IEJyb3dzZXJBY2Nlc3NpYmlsaXR5UHJlZmVyZW5jZXMgfSBmcm9tIFwiQC9hY2Nlc3NpYmlsaXR5L3ByZWZlcmVuY2VzXCI7XG5pbXBvcnQgeyB1c2VNZWRpYVF1ZXJ5IH0gZnJvbSBcIkAvaG9va3MvdXNlLW1lZGlhLXF1ZXJ5XCI7XG5pbXBvcnQgeyB1c2VQcmVmZXJzUmVkdWNlZE1vdGlvbiB9IGZyb20gXCJAL2hvb2tzL3VzZS1wcmVmZXJzLXJlZHVjZWQtbW90aW9uXCI7XG5pbXBvcnQgeyB1c2VQcmVmZXJzTG93Q29udHJhc3QgfSBmcm9tIFwiQC9ob29rcy91c2UtcHJlZmVycy1sb3ctY29udHJhc3RcIjtcbmltcG9ydCB7IHVzZVByZWZlcnNIaWdoQ29udGFzdCB9IGZyb20gXCJAL2hvb2tzL3VzZS1wcmVmZXJzLWhpZ2gtY29udGFzdFwiO1xuaW1wb3J0IHsgdXNlUHJlZmVyc1JlZHVjZWRUcmFuc3BhcmFuY3kgfSBmcm9tIFwiQC9ob29rcy91c2UtcHJlZmVycy1yZWR1Y2VkLXRyYW5zcGFyYW5jeVwiO1xuaW1wb3J0IHsgdXNlUHJlZmVyc0RhcmtNb2RlIH0gZnJvbSBcIkAvaG9va3MvdXNlLXByZWZlcnMtZGFyay1tb2RlXCI7XG5cbmNvbnN0IHVzZUJyb3dzZXJBY2Nlc3NpYmlsaXR5UHJlZmVyZW5jZXMgPVxuICAoKTogQnJvd3NlckFjY2Vzc2liaWxpdHlQcmVmZXJlbmNlcyA9PiB7XG4gICAgY29uc3QgaGFzUmVkdWNlZE1vdGlvbiA9IHVzZVByZWZlcnNSZWR1Y2VkTW90aW9uKCk7XG4gICAgY29uc3QgaGFzSGlnaENvbnRyYXN0ID0gdXNlUHJlZmVyc0hpZ2hDb250YXN0KCk7XG4gICAgY29uc3QgaGFzTG93Q29udHJhc3QgPSB1c2VQcmVmZXJzTG93Q29udHJhc3QoKTtcbiAgICBjb25zdCBoYXNSZWR1Y2VkVHJhbnNwYXJlbmN5ID0gdXNlUHJlZmVyc1JlZHVjZWRUcmFuc3BhcmFuY3koKTtcbiAgICBjb25zdCBoYXNEYXJrTW9kZSA9IHVzZVByZWZlcnNEYXJrTW9kZSgpO1xuXG4gICAgcmV0dXJuIG5ldyBCcm93c2VyQWNjZXNzaWJpbGl0eVByZWZlcmVuY2VzKFxuICAgICAgaGFzUmVkdWNlZE1vdGlvbixcbiAgICAgIGhhc0hpZ2hDb250cmFzdCxcbiAgICAgIGhhc0xvd0NvbnRyYXN0LFxuICAgICAgaGFzUmVkdWNlZFRyYW5zcGFyZW5jeSxcbiAgICAgIGhhc0RhcmtNb2RlLFxuICAgICk7XG4gIH07XG5cbmV4cG9ydCB7IHVzZUJyb3dzZXJBY2Nlc3NpYmlsaXR5UHJlZmVyZW5jZXMgfTtcbiJdfQ==